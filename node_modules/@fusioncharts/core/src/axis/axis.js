import _inheritsLoose from"@babel/runtime/helpers/inheritsLoose";import{ComponentInterface}from"../component-interface";import{UNDEF,parseConfiguration,BLANKSTRING,pluckNumber,setLineHeight,pluckFontSize,parseUnsafeString,getDashStyle,getFirstValue,pluck,pInt,DASH_DEF,NORMAL,PXSTRING,convertColor}from"../lib";var COLOR_333333="333333";var _forceValidLowerLimit=function _forceValidLowerLimit(value,limit){return value<limit?limit:value};var Axis=function(_ComponentInterface){_inheritsLoose(Axis,_ComponentInterface);function Axis(){return _ComponentInterface.apply(this,arguments)||this}var _proto=Axis.prototype;_proto.getType=function getType(){return"axis"};_proto.__setDefaultConfig=function __setDefaultConfig(){_ComponentInterface.prototype.__setDefaultConfig.call(this);this.components={labels:[]};var config=this.config;config.setAdaptiveMin=0;config.adjustDiv=1;config.axisNameWidth=UNDEF;config.rotateAxisName=0;config.useEllipsesWhenOverflow=1;config.divLineColor=UNDEF;config.divLineAlpha=UNDEF;config.divLineThickness=UNDEF;config.divLineIsDashed=UNDEF;config.divLineDashLen=UNDEF;config.divLineDashGap=UNDEF;config.showAlternateGridColor=UNDEF;config.alternateGridColor=UNDEF;config.alternateGridAlpha=UNDEF;config.showZeroPlane=1;config.zeroPlaneAlpha=80;config.showZeroPlaneValue=1;config.showZeroPlaneOnTop=1;config.showAxisLine=UNDEF;config.axisLineThickness=UNDEF;config.axisLineAlpha=UNDEF;config.tickLength=0;config.trendlineToolText=UNDEF;config.trendlineColor=COLOR_333333;config.trendlineThickness=1;config.trendlineAlpha=UNDEF;config.showTrendlinesOnTop=0;config.trendlinesAreDashed=0;config.trendlinesDashLen=5;config.trendlinesDashGap=2;config.isTrendZone=UNDEF;config.showTrendlines=1;config.showTrendlineLabels=1;config.showLabels=1;config.maxLabelHeight=UNDEF;config.rotateLabels=UNDEF;config.slantLabel=0;config.showAxisValues=1;config.showTooltip=1;config.isActive=true;config.drawLabels=true;config.drawOnlyCategoryLine=false;config.drawLabelsOpposit=false;config.drawPlotlines=true;config.drawAxisLine=true;config.drawPlotBands=true;config.drawAxisName=true;config.drawAxisNameOpposit=false;config.axisNameAlignCanvas=false;config.drawAxisNameFromBottom=false;config.drawTrendLines=true;config.drawTrendLabels=true;config.drawTick=true;config.drawTickMinor=true;config.animateAxis=true;config.drawAxisLineWRTCanvas=true;config.isRelativeAxisInverse=false;config.axisIndex=0;config.uniqueClassName=0;config.viewPortRatio={};config.canvas={};config.axisRange={};config.drawnStaggerLines=UNDEF;config.axisDimention={};config.forceZeroTick=true;config.isZeroTickForced=false;config.extremeLabels={firstLabel:{},lastLabel:{}};config._setRangeAgain=false;config._defaultForceDecimal=UNDEF;config._defaultDecimalPrecision=UNDEF;config.rangeChanged=false;config.dimensionChanged=false;config.apparentScrollPos=0;config.visibleMin=UNDEF;config.visibleMax=UNDEF;config.setPadding=false;config.trendLimits=UNDEF};_proto.configureAttributes=function configureAttributes(rawAttr){var axis=this,axisConfig=axis.config,chart=axis.getFromEnv("chart"),jsonData=axis.getFromEnv("dataSource"),is3D=chart.config.is3D,FCChartObj=jsonData.chart,numberFormatter=axis.getFromEnv("number-formatter"),axisAttr,fontBdrColor,trendFontBdrColor,labelFontBdrColor;axisAttr=axisConfig.rawAttr=rawAttr;axisConfig.referenceInfo=[];axisConfig.parsedTrendLabels=[];axisConfig.parsedVlineInfo=[];axisConfig.trendLines=axisAttr.trendlines;axisConfig.vTrendLines=axisAttr.vtrendlines;parseConfiguration(axisAttr,axisConfig);axisConfig.axisName=parseUnsafeString(axisAttr.axisName);axisConfig.axisValuePadding=axisConfig.axisNamePadding||pluckNumber(axisAttr.axisValuePadding,4);axisConfig.axisNamePadding=axisConfig.axisNamePadding||pluckNumber(axisAttr.axisNamePadding,5);axisConfig.maxLabelWidthPercent=pluckNumber(axisAttr.maxLabelWidthPercent);axisConfig.maxLabelWidthPercent=Math.abs(axisConfig.maxLabelWidthPercent);axisConfig.minLabelWidthPercent=Math.abs(pluckNumber(axisAttr.minLabelWidthPercent));axisConfig.numDivLines=pluckNumber(axisAttr.numDivLines,4);axisConfig.numDivLines=_forceValidLowerLimit(axisConfig.numDivLines,0);axisConfig.categoryNumDivLines=pluckNumber(axisAttr.numDivLines,0);axisConfig.axisValuePadding=_forceValidLowerLimit(axisConfig.axisValuePadding,0);axisConfig.isReverse=pluckNumber(axisAttr.isReverse,0);axisConfig.isOpposit=pluckNumber(axisAttr.isOpposit,0);axisConfig.isVertical=pluckNumber(axisAttr.isVertical,0);axisConfig.categoryDivLinesFromZero=1;axisConfig.axisMinValue=numberFormatter.getCleanValue(axisAttr.axisMinValue);axisConfig.axisMaxValue=numberFormatter.getCleanValue(axisAttr.axisMaxValue);axisConfig.zeroPlaneColor=pluck(axisAttr.zeroPlaneColor,axisAttr.divLineColor);axisConfig.zeroPlaneThickness=pluck(axisAttr.zeroPlaneThickness,axisAttr.divLineThickness);axisConfig.axisLineColor=convertColor(axisAttr.axisLineColor,axisAttr.axisLineAlpha);axisConfig.tickAlpha=pluckNumber(axisAttr.tickAlpha,axisConfig.axisLineAlpha);axisConfig.tickColor=convertColor(pluck(axisAttr.tickColor,axisAttr.axisLineColor),axisConfig.tickAlpha);axisConfig.tickWidth=pluckNumber(axisAttr.tickWidth,axisConfig.axisLineThickness);axisConfig.maxZoomLimit=pluckNumber(FCChartObj.maxzoomlimit,chart.maxzoomlimit,1e3);axisConfig.showVLines=pluckNumber(FCChartObj.showvlines,1);axisConfig.showVLinesOnTop=pluckNumber(FCChartObj.showvlinesontop,0);axisConfig.showVLineLabels=pluckNumber(FCChartObj.showvlinelabels,this.showVLineLabels,1);axisConfig.showVLineLabelBorder=pluckNumber(FCChartObj.showvlinelabelborder,1);axisConfig.rotateVLineLabels=pluckNumber(FCChartObj.rotatevlinelabels,0);axisConfig.vLineColor=pluck(FCChartObj.vlinecolor,"333333");axisConfig.vLineLabelColor=pluck(FCChartObj.vlinelabelcolor);axisConfig.vLineThickness=pluck(FCChartObj.vlinethickness,1);axisConfig.vLineAlpha=pluckNumber(FCChartObj.vlinealpha,80);axisConfig.vLineLabelBgColor=pluck(FCChartObj.vlinelabelbgcolor,"ffffff");axisConfig.vLineLabelBgAlpha=pluckNumber(FCChartObj.vlinelabelbgalpha,is3D?50:100);axisConfig.staggerLines=Math.max(pluckNumber(FCChartObj.staggerlines,2),2);axisConfig.staggerLines=_forceValidLowerLimit(axisConfig.staggerLines,1);axisConfig.trendlineValuesOnOpp=pluck(axisAttr.trendlineValuesOnOpp,axisAttr.trendlineValuesOnOpp,0);axisConfig.labelDisplay=pluck(axisAttr.labelDisplay,"auto").toLowerCase();axisConfig.labelStep=pluckNumber(axisAttr.labelStep,1);axisConfig.labelStep=Math.round(axisConfig.labelStep);axisConfig.labelStep=_forceValidLowerLimit(axisConfig.labelStep,1);axisConfig.startPad=0;axisConfig.endPad=0;axisConfig._oriLabelStep=axisConfig.labelStep;axisConfig.showLimits=pluckNumber(axisAttr.showLimits,axisConfig.showAxisValues);axisConfig.showUpperLimit=axisAttr.showLimits;axisConfig.showDivLineValues=pluckNumber(axisAttr.showDivLineValues,axisConfig.showAxisValues);axisConfig.showCanvasBorder=chart.getChildren("canvas")[0].config.showCanvasBorder?1:0;axisConfig.axisBreak=axisAttr.axisBreaks;axisConfig.isBreak=!!axisConfig.axisBreak;if(axisConfig.isBreak){axis._processAxisBreak()}fontBdrColor=getFirstValue(axisAttr.axisNameBorderColor,BLANKSTRING);fontBdrColor=fontBdrColor?convertColor(fontBdrColor,pluckNumber(axisAttr.axisNameBorderAlpha,axisAttr.axisNameAlpha,100)):BLANKSTRING;axisConfig.name=axisConfig.name||{};axisConfig.name.style={fontFamily:pluck(axisAttr.axisNameFont,axisAttr.outCanfontFamily),fontSize:pluck(axisAttr.axisNameFontSize,pInt(axisAttr.outCanfontSize))+PXSTRING,color:convertColor(pluck(axisAttr.axisNameFontColor,axisAttr.outCancolor),pluckNumber(axisAttr.axisNameFontAlpha,axisAttr.axisNameAlpha,100)),fontWeight:pluckNumber(axisAttr.axisNameFontBold,1)?"bold":NORMAL,fontStyle:pluckNumber(axisAttr.axisNameFontItalic)?"italic":NORMAL,border:fontBdrColor||axisAttr.axisNameBgColor?pluckNumber(axisAttr.axisNameBorderThickness,1)+"px solid":UNDEF,borderColor:fontBdrColor,borderThickness:pluckNumber(axisAttr.axisNameBorderThickness,1),borderPadding:pluckNumber(axisAttr.axisNameBorderPadding,2),borderRadius:pluckNumber(axisAttr.axisNameBorderRadius,0),backgroundColor:axisAttr.axisNameBgColor?convertColor(axisAttr.axisNameBgColor,pluckNumber(axisAttr.axisNameBgAlpha,axisAttr.axisNameAlpha,100)):BLANKSTRING,borderDash:pluckNumber(axisAttr.axisNameBorderDashed,0)?getDashStyle(pluckNumber(axisAttr.axisNameBorderDashLen,4),pluckNumber(axisAttr.axisNameBorderDashGap,2)):DASH_DEF};axisConfig.name.style.lineHeight=setLineHeight(axisConfig.name.style);trendFontBdrColor=getFirstValue(FCChartObj.trendvaluebordercolor,BLANKSTRING);trendFontBdrColor=trendFontBdrColor?convertColor(trendFontBdrColor,pluckNumber(FCChartObj.trendvalueborderalpha,FCChartObj.trendvaluealpha,100)):BLANKSTRING;axisConfig.trend=axisConfig.trend||{};axisConfig.trend.trendStyle={fontFamily:pluck(FCChartObj.trendvaluefont,axisAttr.outCanfontFamily),color:pluck(FCChartObj.trendvaluefontcolor,axisAttr.trendlineColor,axisAttr.outCancolor,"333333"),valueAlpha:FCChartObj.trendvaluealpha,fontSize:pluckFontSize(FCChartObj.trendvaluefontsize,pInt(axisAttr.outCanfontSize))+PXSTRING,fontWeight:pluckNumber(FCChartObj.trendvaluefontbold)?"bold":NORMAL,fontStyle:pluckNumber(FCChartObj.trendvaluefontitalic)?"italic":NORMAL,border:trendFontBdrColor||FCChartObj.trendvaluebgcolor?pluckNumber(FCChartObj.trendvalueborderthickness,1)+"px solid":"",borderColor:trendFontBdrColor,borderThickness:pluckNumber(FCChartObj.trendvalueborderthickness,1),borderPadding:pluckNumber(FCChartObj.trendvalueborderpadding,2),borderRadius:pluckNumber(FCChartObj.trendvalueborderradius,0),backgroundColor:FCChartObj.trendvaluebgcolor?convertColor(FCChartObj.trendvaluebgcolor,pluckNumber(FCChartObj.trendvaluebgalpha,FCChartObj.trendvaluealpha,100)):BLANKSTRING,borderDash:pluckNumber(FCChartObj.trendvalueborderdashed,0)?getDashStyle(pluckNumber(FCChartObj.trendvalueborderdashlen,4),pluckNumber(FCChartObj.trendvalueborderdashgap,2)):DASH_DEF};axisConfig.trend.trendStyle.lineHeight=setLineHeight(axisConfig.trend.trendStyle);axisConfig.labels=axisConfig.labels||{};axisConfig.lines=axisConfig.lines||{};axisConfig.band=axisConfig.band||{};labelFontBdrColor=getFirstValue(axisAttr.labelBdrColor,BLANKSTRING);labelFontBdrColor=labelFontBdrColor?convertColor(labelFontBdrColor,pluckNumber(axisAttr.labelBdrAlpha,axisAttr.labelAlpha,100)):BLANKSTRING;axisConfig.labels.style={fontFamily:pluck(axisAttr.labelFont,axisAttr.outCanfontFamily),fontSize:pluckNumber(axisAttr.labelFontSize,pInt(axisAttr.outCanfontSize))+PXSTRING,fontWeight:pluckNumber(axisAttr.labelFontBold)?"bold":NORMAL,fontStyle:pluckNumber(axisAttr.labelFontItalic)?"italic":NORMAL,color:convertColor(pluck(axisAttr.labelFontColor,axisAttr.outCancolor),pluckNumber(axisAttr.labelAlpha,100)),labelLink:axisAttr.labelLink,border:labelFontBdrColor||axisAttr.labelBgColor?pluckNumber(axisAttr.labelBdrThickness,1)+"px solid":"",borderColor:labelFontBdrColor,borderThickness:pluckNumber(axisAttr.labelBdrThickness,1),borderPadding:pluckNumber(axisAttr.labelBdrPadding,2),borderRadius:pluckNumber(axisAttr.labelBdrRadius,0),backgroundColor:axisAttr.labelBgColor?convertColor(axisAttr.labelBgColor,pluckNumber(axisAttr.labelBgAlpha,axisAttr.labelAlpha,100)):BLANKSTRING,borderDash:pluckNumber(axisAttr.labelBdrDashed,0)?getDashStyle(pluckNumber(axisAttr.labelBdrDashLen,4),pluckNumber(axisAttr.labelBdrDashGap,2)):DASH_DEF};axisConfig.labels.style.lineHeight=setLineHeight(axisConfig.labels.style);axisConfig.numberFormatterFn=pluck(axisAttr.numberFormatterFn);axisConfig.apparentScrollPos=axisAttr.apparentScrollPos||axisConfig.apparentScrollPos;axisConfig.axisRange={};axisConfig.dataLimit={};axisConfig.axisEndLabelDisplaySpace={left:0,right:0,top:0,bottom:0};axisConfig.isConfigured=true;axisConfig._defaultForceDecimal=UNDEF;axisConfig._defaultDecimalPrecision=UNDEF;axisConfig.lines.isDraw=pluckNumber(axisAttr.lines&&axisAttr.lines.isDraw,1);axisConfig.band.isDraw=pluckNumber(axisAttr.band&&axisAttr.band.isDraw,1)};_proto.createContainer=function createContainer(containerName,attr,container){var animationManager=this.getFromEnv("animationManager");return this.addContainer(containerName,animationManager.setAnimation({container:container,attr:attr,el:this.getContainer(containerName)||"group",component:this,label:"group"}))};_proto.createGroup=function createGroup(containerName,attr,container,label){if(label===void 0){label="group"}var animationManager=this.getFromEnv("animationManager");return animationManager.setAnimation({container:container,attr:attr,el:this.config[containerName]||"group",component:this,label:label})};_proto.getValuePadding=function getValuePadding(){var axisConfig=this.config;return{left:axisConfig.startPad,right:axisConfig.endPad}};_proto.draw=function draw(){var axis=this,axisConfig=axis.config,chart=axis.getFromEnv("chart"),chartConfig=chart.config,isVertical=axisConfig.isVertical,viewPortConfig=chartConfig.viewPortConfig,limitUpdaters=axis.getChildren().limitUpdater,viewPortRatio=axisConfig.viewPortRatio||{},dx,dy,originY,originX;axis._createContainer();originY=viewPortConfig.y*viewPortConfig.scaleY;originX=viewPortConfig.x*viewPortConfig.scaleX;if(viewPortRatio.scaleX&&viewPortRatio.scaleY&&(viewPortRatio.scaleX!==viewPortConfig.scaleX||viewPortRatio.scaleY!==viewPortConfig.scaleY)){viewPortRatio.scaleX=viewPortConfig.scaleX;viewPortRatio.scaleY=viewPortConfig.scaleY;axis._drawComponents()}else{if(isVertical){dy=originY-viewPortConfig.y*viewPortConfig.scaleY;axisConfig.axisContainer.transform("t0,"+dy);axisConfig.axisLabelContainerTop.transform("t0,"+dy)}else{dx=originX-viewPortConfig.x*viewPortConfig.scaleX;axisConfig.axisContainer.transform("t"+dx+",0");axisConfig.axisLabelContainerTop.transform("t"+dx+",0")}axis._drawComponents()}axis.addExtEventListener("animationcomplete",function(){limitUpdaters&&limitUpdaters.forEach(function(limitUpdater){limitUpdater.draw()})},axis.getFromEnv("animationmanager"));axis.addToEnv("prevScale",axis.getScale().copy())};_proto.setScale=function setScale(scale){this.config.scale=scale};_proto.getScale=function getScale(){return this.config.scale};_proto.getLimit=function getLimit(){var axisRange=this.config.axisRange;return{min:axisRange.min,max:axisRange.max,tickInterval:axisRange.tickInterval}};_proto.getVisibleConfig=function getVisibleConfig(){var axisConfig=this.config;return{minValue:axisConfig.visibleMin,maxValue:axisConfig.visibleMax}};_proto.setAxisConfig=function setAxisConfig(data){var axis=this,axisConfig=axis.config,prop;for(prop in data){if(data.hasOwnProperty(prop)){axisConfig[prop]=data[prop]}}};_proto.getAxisConfig=function getAxisConfig(name){var axis=this,axisConfig=axis.config;if(name){return axisConfig[name]}return axisConfig};_proto.getVisibleLength=function getVisibleLength(){var axis=this,limit=axis.getVisibleConfig();return Math.abs(limit.maxValue-limit.minValue)};_proto.getAxisEndLabelDisplaySpace=function getAxisEndLabelDisplaySpace(){return this.config.axisEndLabelDisplaySpace||{}};_proto.getTicksLen=function getTicksLen(){var tickInfo=this.config.tickValues;return tickInfo&&tickInfo.tickValue.length||0};return Axis}(ComponentInterface);export default Axis;