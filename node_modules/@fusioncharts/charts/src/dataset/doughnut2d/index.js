import _inheritsLoose from"@babel/runtime/helpers/inheritsLoose";import Pie2DDataset from"../pie2d";import{addDep}from"@fusioncharts/core/src/dependency-manager";import{hasSVG,pluckNumber,pluck}from"@fusioncharts/core/src/lib";import doughnut2dAnimation from"./index.animation";var COMMASTRING=",",FIFTY_PERCENT="50%",_getInnerSize2=function _getInnerSize(){var innerradius,dataSet=this,chart=dataSet.getFromEnv("chart"),dataSetConfig=dataSet.config,chartAttr=chart.getFromEnv("dataSource").chart,doughnutRadius=dataSetConfig.doughnutradius,use3DLighting=pluckNumber(chartAttr.use3dlighting,1),radius3D=use3DLighting?pluckNumber(chartAttr.radius3d,chartAttr["3dradius"],50):100,innerpercentR,diff50Percent,radius3Dpercent,pointConfig,poin2nd,ratioStr,x,point,data,length,pieMinRadius=dataSetConfig.pieMinRadius;if(radius3D>100){radius3D=100}if(radius3D<0){radius3D=0}if(/%/.test(doughnutRadius)){doughnutRadius=Number(doughnutRadius.split("%")[0])/100;innerradius=pieMinRadius*doughnutRadius}else if(doughnutRadius<=0||doughnutRadius>=pieMinRadius){innerradius=pieMinRadius/2}else{innerradius=pluckNumber(doughnutRadius)}dataSetConfig.innerRadius=innerradius;if(radius3D>0&&hasSVG){innerpercentR=parseInt(innerradius/pieMinRadius*100,10);diff50Percent=(100-innerpercentR)/2;radius3Dpercent=parseInt(diff50Percent*radius3D/100,10);poin2nd=2*(diff50Percent-radius3Dpercent);ratioStr=innerpercentR+COMMASTRING+radius3Dpercent+COMMASTRING+poin2nd+COMMASTRING+radius3Dpercent;if(dataSet&&(data=dataSet.components.data)){for(x=0,length=data.length;x<length;x+=1){point=data[x];pointConfig=point.config;if(pointConfig.color){pointConfig.color.ratio=ratioStr;if(pointConfig.hoverEffects&&pointConfig.hoverEffects.color){pointConfig.hoverEffects.color.ratio=ratioStr}}}}}return innerradius*2};addDep({name:"doughnut2dAnimation",type:"animationRule",extension:doughnut2dAnimation});var Doughnut2DDataset=function(_Pie2DDataset){_inheritsLoose(Doughnut2DDataset,_Pie2DDataset);function Doughnut2DDataset(){return _Pie2DDataset.apply(this,arguments)||this}var _proto=Doughnut2DDataset.prototype;_proto.getType=function getType(){return"dataset"};_proto.getName=function getName(){return"doughnut2D"};_proto.configureAttributes=function configureAttributes(dataObj){_Pie2DDataset.prototype.configureAttributes.call(this,dataObj);var dataset=this,conf=dataset.config,chartConfig=dataset.getFromEnv("chartConfig");conf.doughnutradius=pluck(chartConfig.doughnutradius,conf.doughnutradius,"50%")};_proto.__setDefaultConfig=function __setDefaultConfig(){_Pie2DDataset.prototype.__setDefaultConfig.call(this);this.config.doughnutradius=FIFTY_PERCENT};_proto._parsePiePlotOptions=function _parsePiePlotOptions(){var dataSet=this,piePlotOptions=_Pie2DDataset.prototype._parsePiePlotOptions.call(this);piePlotOptions.innerSize=dataSet._getInnerSize();return piePlotOptions};_proto._getInnerSize=function _getInnerSize(){return _getInnerSize2.call(this)};_proto.allocatePosition=function allocatePosition(){this.config.innerSize=this._getInnerSize();_Pie2DDataset.prototype.allocatePosition.call(this)};return Doughnut2DDataset}(Pie2DDataset);export{_getInnerSize2 as _getInnerSize};export default Doughnut2DDataset;