import _inheritsLoose from"@babel/runtime/helpers/inheritsLoose";import LineDataset from"../line";import{BLANKSTRING,BGRATIOSTRING,extend2,pluck,pluckNumber,toRaphaelColor,HUNDREDSTRING,getFirstValue,parseTooltext,parseUnsafeString,getDefinedColor,getDashStyle,getValidValue,getDarkColor,getLightColor,getFirstAlpha,getFirstColor}from"@fusioncharts/core/src/lib";import{addDep}from"@fusioncharts/core/src/dependency-manager";import KdTree from"../_internal/kdtree";import scatterAnimation from"./index.animation";var math=Math,mathMax=math.max,mathMin=math.min,mathRound=math.round;var UNDEF,COMMA=",",NONE="none",COMMASTRING=",",PLOTGRADIENTCOLOR="plotGradientColor",SHOWSHADOW="showShadow",getPointColor=function getPointColor(clr,alph){var colorObj,innerColor,outerColor,color=clr,alpha=alph;color=getFirstColor(color);alpha=getFirstAlpha(alpha);innerColor=getLightColor(color,70);outerColor=getDarkColor(color,50);colorObj={FCcolor:{gradientUnits:"objectBoundingBox",cx:.4,cy:.4,r:"100%",color:innerColor+COMMASTRING+outerColor,alpha:alpha+COMMASTRING+alpha,ratio:BGRATIOSTRING,radialGradient:true}};return colorObj};addDep({name:"scatterAnimation",type:"animationRule",extension:scatterAnimation});var ScatterDataset=function(_LineDataset){_inheritsLoose(ScatterDataset,_LineDataset);function ScatterDataset(){return _LineDataset.apply(this,arguments)||this}var _proto=ScatterDataset.prototype;_proto.getType=function getType(){return"dataset"};_proto.setupHoverTracker=function setupHoverTracker(){var dataset=this,searchDataArr=dataset.config.searchDataArr=[],dsComponents=dataset.components,dataStore=dsComponents.data,anchorProps={},i,j,ii,xPos,yPos,dataObj,plotConfig,skippingInfo=dataset.getSkippingInfo&&dataset.getSkippingInfo(),plotDrawArray=skippingInfo&&skippingInfo.draw||[],plotDrawArrayLength=plotDrawArray.length,skippingApplied=skippingInfo&&skippingInfo.skippingApplied;ii=dataStore.length;if(skippingApplied){ii=plotDrawArrayLength}for(j=0;j<ii;j++){i=plotDrawArray[j]||[j];dataObj=dataStore[i];if(dataObj){plotConfig=dataObj.config;xPos=plotConfig._Px;yPos=plotConfig._Py;anchorProps=plotConfig.anchorProps;searchDataArr.push({x:xPos,y:yPos,index:i,data:dataObj,r:anchorProps.radius||0})}}this.config.dataTree=(new KdTree).buildKdTree(searchDataArr)};_proto.getName=function getName(){return"scatter"};_proto.configureAttributes=function configureAttributes(datasetJSON){if(!datasetJSON){return false}this.trimData(datasetJSON);this.config.JSONData=datasetJSON;var plotBorderDash,parentYAxis,enableAnimation,defaultShadow,dataSet=this,chart=dataSet.getFromEnv("chart"),conf=dataSet.config,JSONData=conf.JSONData,areaAlpha=chart.areaAlpha,chartAttr=chart.getFromEnv("dataSource").chart,colorM=dataSet.getFromEnv("color-manager"),showplotborder=pluckNumber(JSONData.showplotborder,chartAttr.showplotborder||1),plotFillColor=colorM.getPlotColor(dataSet.index),usePlotGradientColor,lineDashed=conf.lineDashed=pluckNumber(JSONData.linedashed,JSONData.dashed,chartAttr.linedashed,0),isLineSet=dataSet.isLineSet;conf.plotColor=plotFillColor;defaultShadow=pluckNumber(chart.defaultPlotShadow,colorM.getColor(SHOWSHADOW));conf.xAxisLabelMode=pluck(chartAttr.xaxislabelmode,"categories");conf.toolTipSepChar=pluck(chartAttr.tooltipsepchar,", ");conf.defaultValuePadding={left:0,right:0};if(isLineSet){conf.parentYAxis=parentYAxis=1}else{conf.parentYAxis=parentYAxis=pluck(JSONData.parentyaxis&&JSONData.parentyaxis.toLowerCase(),"p")==="s"?1:0}dataSet.config.yAxis=dataSet.getFromEnv("yAxis")[parentYAxis];conf.connectNullData=pluckNumber(chartAttr.connectnulldata,0);conf.seriesname=parseUnsafeString(JSONData.seriesname);conf.includeinlegend=pluckNumber(JSONData.includeinlegend,conf.seriesname?1:0);conf.showTextOutline=pluckNumber(chartAttr.textoutline,0);conf.enableAnimation=enableAnimation=pluckNumber(chartAttr.animation,chartAttr.defaultanimation,1);conf.animation=!enableAnimation?false:{duration:pluckNumber(chartAttr.animationduration,1)*1e3};conf.transposeanimation=pluckNumber(chartAttr.transposeanimation,enableAnimation);conf.transposeanimduration=pluckNumber(chartAttr.transposeanimduration,.2)*1e3;conf.showvalues=pluckNumber(JSONData.showvalues,chartAttr.showvalues);conf.valuePadding=pluckNumber(chartAttr.valuepadding,2);conf.valuePosition=pluck(JSONData.valueposition,chartAttr.valueposition,"auto");conf.showTooltip=pluckNumber(chartAttr.showtooltip,1);conf.seriesNameInTooltip=pluckNumber(chartAttr.seriesnameintooltip,1);conf.plotFillColor=conf.plotfillcolor=pluck(JSONData.color,chartAttr.plotfillcolor,plotFillColor);conf.plotFillAngle=conf.plotFillAngle=pluck(chartAttr.plotfillangle,270);conf.plotFillAlpha=conf.plotfillalpha=pluck(JSONData.alpha,chartAttr.plotfillalpha,areaAlpha,"70");usePlotGradientColor=pluckNumber(chartAttr.useplotgradientcolor,1);conf.plotGradientColor=conf.plotgradientcolor=usePlotGradientColor!==0?getDefinedColor(chartAttr.plotgradientcolor,colorM.getColor(PLOTGRADIENTCOLOR)):"";conf.fillColor=conf.fillcolor={color:conf.plotfillcolor+(conf.plotgradientcolor?COMMA+conf.plotgradientcolor:BLANKSTRING),alpha:conf.plotfillalpha,angle:conf.plotFillAngle};conf.plotBorderAlpha=conf.plotborderalpha=showplotborder?pluck(JSONData.plotborderalpha,chartAttr.plotborderalpha,JSONData.alpha,"95"):0;conf.plotBorderColor=conf.plotbordercolor=pluck(JSONData.plotbordercolor,chartAttr.plotbordercolor,chartAttr.areabordercolor,"666666");conf.dashed=plotBorderDash=pluckNumber(JSONData.dashed,chartAttr.plotborderdashed);conf.plotBorderDashLen=conf.plotborderdashlen=pluck(JSONData.plotborderdashlen,chartAttr.plotborderdashlen,5);conf.plotBorderDashGap=conf.plotborderdashgap=pluck(JSONData.plotborderdashgap,chartAttr.plotborderdashgap,4);conf.plotBorderThickness=conf.plotborderthickness=pluckNumber(JSONData.plotborderthickness,chartAttr.plotborderthickness,1);conf.plotBorderDashStyle=conf.plotborderdashstyle=plotBorderDash?getDashStyle(conf.plotborderdashlen,conf.plotborderdashgap):"none";conf.showHoverEffect=conf.showhovereffect=pluckNumber(chartAttr.plothovereffect,chartAttr.anchorhovereffect,chartAttr.showhovereffect,UNDEF);conf.rotateValues=pluckNumber(chartAttr.rotatevalues)?270:0;conf.drawLine=pluckNumber(JSONData.drawline,chartAttr.drawlines,0);conf.lineThickness=conf.linethickness=pluckNumber(JSONData.linethickness,chartAttr.linethickness,2);conf.lineDashLen=conf.linedashlen=pluckNumber(JSONData.linedashlen,chartAttr.linedashlen,5);conf.lineDashGap=conf.linedashgap=pluckNumber(JSONData.linedashgap,chartAttr.linedashgap,4);conf.lineAlpha=conf.linealpha=pluckNumber(JSONData.linealpha,chartAttr.linealpha,JSONData.alpha,HUNDREDSTRING);conf.lineColor=conf.linecolor=pluck(JSONData.linecolor,chartAttr.linecolor,JSONData.color,conf.plotColor);conf.lineDashStyle=conf.linedashstyle=getDashStyle(conf.linedashlen,conf.linedashgap);conf.lineDashStyle=conf.linedashstyle=lineDashed?conf.linedashstyle:NONE;conf.shadow={opacity:pluckNumber(chartAttr.showshadow,defaultShadow)?conf.linealpha/100:0};conf.drawanchors=pluckNumber(JSONData.drawanchors,JSONData.showanchors,chartAttr.drawanchors,chartAttr.showanchors);conf.anchorbgcolor=getFirstColor(pluck(JSONData.anchorbgcolor,chartAttr.anchorbgcolor,colorM.getColor("anchorBgColor")));conf.anchorbordercolor=getFirstColor(pluck(JSONData.anchorbordercolor,JSONData.color,chartAttr.anchorbordercolor,conf.linecolor));conf.anchorradius=pluckNumber(JSONData.anchorradius,chartAttr.anchorradius,3);conf.anchoralpha=pluck(JSONData.anchoralpha,JSONData.alpha,chartAttr.anchoralpha,HUNDREDSTRING);conf.anchorbgalpha=pluck(JSONData.anchorbgalpha,JSONData.alpha,chartAttr.anchorbgalpha,HUNDREDSTRING);conf.anchorborderthickness=pluck(JSONData.anchorborderthickness,chartAttr.anchorborderthickness,1);conf.anchorsides=pluckNumber(JSONData.anchorsides,chartAttr.anchorsides,conf.index+3);conf.anchorimageurl=pluck(JSONData.anchorimageurl,chartAttr.anchorimageurl);conf.anchorimagealpha=pluckNumber(JSONData.anchorimagealpha,chartAttr.anchorimagealpha,100);conf.anchorimagescale=pluckNumber(JSONData.anchorimagescale,chartAttr.anchorimagescale,100);conf.anchorimagepadding=pluckNumber(JSONData.anchorimagepadding,chartAttr.anchorimagepadding,1);conf.anchorstartangle=pluckNumber(JSONData.anchorstartangle,chartAttr.anchorstartangle,90);conf.anchorshadow=pluckNumber(JSONData.anchorshadow,chartAttr.anchorshadow,0);conf.plotToolText=getValidValue(parseUnsafeString(pluck(JSONData.plottooltext,chartAttr.plottooltext)));dataSet.setState("visible",pluckNumber(JSONData.visible,!Number(JSONData.initiallyhidden),1)===1);dataSet._setConfigure();chart.config.hasLegend!==false&&chart.config.showLegend&&dataSet._addLegend();dataSet.setState("dirty",true)};_proto.calculateScrollRange=function calculateScrollRange(){var dataSet=this,dsConfig=dataSet.config,chart=dataSet.getFromEnv("chart"),xAxis=dataSet.getFromEnv("xAxis"),hasScroll=chart.hasScroll,dataStore=dataSet.components.data,dsLen=dataStore.length;dsConfig.scrollMinVal=hasScroll?mathMax(mathRound(xAxis.getVisibleConfig().minValue)-1,0):0;dsConfig.scrollMaxVal=hasScroll?mathMin(mathRound(xAxis.getVisibleConfig().maxValue)+2,dsLen):dsLen;dsConfig.scrollMinValForLabel=dsConfig.scrollMinVal;dsConfig.scrollMaxValForLabel=dsConfig.scrollMaxVal};_proto._setConfigure=function _setConfigure(){var i,config,dataObj,setData,setValue,toolText,toolTipValue,macroIndices,parserConfig,formatedVal,formatedValX,setDisplayValue,infMin=-Infinity,infMax=+Infinity,yMax=infMin,yMin=infMax,xMin=infMax,xMax=infMin,dataSet=this,dataStore=dataSet.components.data||(dataSet.components.data=[]),chart=dataSet.getFromEnv("chart"),conf=dataSet.config,JSONData=conf.JSONData,chartAttr=chart.getFromEnv("dataSource").chart,setDataArr=JSONData.data||[],dataSetLen=setDataArr.length,numberFormatter=dataSet.getFromEnv("number-formatter"),yAxisName=parseUnsafeString(chartAttr.yaxisname),xAxisName=parseUnsafeString(chartAttr.xaxisname),lineDashed=conf.lineDashed,lineDashStyle=conf.linedashstyle,parentYAxis=conf.parentYAxis,tooltipSepChar=conf.toolTipSepChar,seriesname=conf.seriesname;conf.imageCount=0;for(i=0;i<dataSetLen;i+=1){setData=setDataArr[i];dataObj=dataStore[i]||(dataStore[i]={});config=dataObj.config||(dataObj.config={});config.setValue=setValue={x:numberFormatter.getCleanValue(setData.x),y:numberFormatter.getCleanValue(setData.y)};if(setValue.x!==null&&setValue.y!==null){if(setValue.x>xMax){xMax=setValue.x;conf.rightMostData=dataObj}if(setValue.x<xMin){xMin=setValue.x;conf.leftMostData=dataObj}if(setValue.y>yMax){yMax=setValue.y;conf.topMostData=dataObj}if(setValue.y<yMin){yMin=setValue.y;conf.bottomMostData=dataObj}}config._x=setValue.x;config._y=setValue.y;config.setLink=pluck(setData.link);config.anchorProps=this._parseAnchorProperties(i);config.showValue=pluckNumber(setData.showvalue,conf.showvalues);config.dashed=pluckNumber(setData.dashed,lineDashed);config.color=pluck(setData.color,conf.linecolor);config.alpha=pluck(setData.alpha,conf.linealpha);config.dashStyle=config.dashed?lineDashStyle:"none";config.toolTipValue=toolTipValue=numberFormatter.dataLabels(setValue.y,parentYAxis);config.setDisplayValue=setDisplayValue=parseUnsafeString(setData.displayvalue);formatedVal=config.formatedVal=pluck(setData.toolTipValue,numberFormatter.dataLabels(setValue.y,parentYAxis));formatedValX=numberFormatter.xAxis(setValue.x);config.displayValue=pluck(setDisplayValue,toolTipValue);config.setTooltext=getValidValue(parseUnsafeString(pluck(setData.tooltext,conf.plotToolText)));if(!conf.showTooltip){toolText=false}else if(config.setTooltext!==UNDEF){macroIndices=[4,5,6,7,8,9,10,11];parserConfig={yaxisName:yAxisName,xaxisName:xAxisName,yDataValue:formatedVal,xDataValue:formatedValX};toolText=parseTooltext(config.setTooltext,macroIndices,parserConfig,setData,chartAttr,JSONData)}else{if(formatedVal===null){toolText=false}else{toolText=seriesname?seriesname+tooltipSepChar:BLANKSTRING;toolText+=setValue.x?formatedValX+tooltipSepChar:BLANKSTRING;toolText+=toolTipValue}}config.toolText=toolText;if(!dataObj){dataObj=dataStore[i]={graphics:{}}}else if(!dataObj.graphics){dataStore[i].graphics={}}config.hoverEffects=this._parseHoverEffectOptions(dataObj,setData);config.anchorProps.isAnchorHoverRadius=config.hoverEffects.anchorRadius}conf.xMax=xMax;conf.xMin=xMin;conf.yMin=yMin;conf.yMax=yMax;dataSet.ErrorValueConfigure&&dataSet.ErrorValueConfigure()};_proto._getHoveredPlot=function _getHoveredPlot(x,y){var res=this.config.dataTree.getNeighbour({x:x,y:y},true);if(res){return{pointIndex:res.index||res.i,hovered:true,pointObj:res.data}}};_proto.drawPlots=function drawPlots(){_LineDataset.prototype.drawPlots.call(this);this.setupHoverTracker()};_proto.getRegressionPoints=function getRegressionPoints(){var dataset=this,regression=dataset.getChildren("regression"),regressionPoints,xMax=-Infinity,xMin=Infinity,yMax=-Infinity,yMin=Infinity,i,j,k,line,points,regLineLength,regPointsLength;if(!regression||!regression.length||regression[0].getState("removed")){return}regressionPoints=regression[0]._config.regressionPoints||[];regLineLength=regressionPoints.length;for(i=0;i<regLineLength;i++){line=regressionPoints[i];for(j=0;j<line.length;j++){points=line[j]||[];regPointsLength=points.length;for(k=0;k<regPointsLength;k++){xMax=Math.max(xMax,points[k].x);xMin=Math.min(xMin,points[k].x);yMax=Math.max(yMax,points[k].y);yMin=Math.min(yMin,points[k].y)}}}return{max:yMax,min:yMin,xMax:xMax,xMin:xMin}};_proto.getDataLimits=function getDataLimits(){var dataset=this,conf=dataset.config,chart=dataset.getFromEnv("chart"),chartConfig=chart.config,max=conf.yMax,min=conf.yMin,xMax=conf.xMax,xMin=conf.xMin,infMin=-Infinity,infMax=+Infinity,transposeAxis=chartConfig.transposeAxis,regressionPoints=dataset.getRegressionPoints();if(dataset.getState("visible")===false&&transposeAxis){max=infMin;min=infMax;xMax=infMin;xMin=infMax}if(regressionPoints){max=Math.max(max,regressionPoints.max);min=Math.min(min,regressionPoints.min);xMax=Math.max(xMax,regressionPoints.xMax);xMin=Math.min(xMin,regressionPoints.xMin)}return{max:max,min:min,xMax:xMax,xMin:xMin}};_proto.getAxisValuePadding=function getAxisValuePadding(){return this.config.defaultValuePadding};_proto.getCanvasPadding=function getCanvasPadding(){var dataset=this,conf=dataset.config||(dataset.config={}),components=dataset.components||{},chartConfig=dataset.getFromEnv("chartConfig"),rotateValues=chartConfig.rotatevalues,xAxis=dataset.getFromEnv("xAxis"),yAxis=dataset.getFromEnv("yAxis"),reversexaxis=xAxis.config.isReverse,dataLabelStyle=dataset.getFromEnv("dataLabelStyle"),data=components.data||[],dataLen=data.length,firstData=conf.leftMostData||data[0],lastData=conf.rightMostData||data[data.length-1],topMostData=conf.topMostData,bottomMostData=conf.bottomMostData,radiusLimit=mathMin(chartConfig.canvasHeight,chartConfig.canvasWidth)/8,sqrtMaxZ,startValue=xAxis.getValue(0),firstDataChangeFlag=1,secondDataChangeFlag=1,radiusFactor,configAttr,configAttrFirst,configAttrLast,dataConf,anchorRadius,zMax=chartConfig.zMax,sqrtBubbleZ,minPoint,bubbleScale=conf.bubbleScale,i,xReduced,xReducedFirst,xReducedLast,label,bubbleRadius,bubbleRadiusVal,labelDimEnd={},labelDimStart={},anchorSpace=0,labelSpace=0,showValue,xAxisRange=xAxis.config.axisRange,xAxisMin=xAxisRange.min,xAxisMax=xAxisRange.max,yAxisRange=yAxis.config.axisRange,yAxisMin=yAxisRange.min,yAxisMax=yAxisRange.max,startPixel=xAxis.getPixel(xAxisMin),endPixel=xAxis.getPixel(xAxisMax),SmartLabel=dataset.getFromEnv("smartLabel"),returnDimension={paddingLeft:0,paddingRight:0},labelWidth=0,yReduced;sqrtMaxZ=Math.sqrt(zMax);radiusFactor=radiusLimit/sqrtMaxZ;for(i=0;i<dataLen;i++){configAttr=data[i].config;configAttrFirst=firstData.config;configAttrLast=lastData.config;sqrtBubbleZ=Math.sqrt(configAttr.z);bubbleRadius=Math.round(sqrtBubbleZ*radiusFactor)*bubbleScale||0;bubbleRadiusVal=xAxis.getValue(bubbleRadius)-startValue;xReduced=configAttr.x-bubbleRadiusVal/2;if(firstDataChangeFlag===1){sqrtBubbleZ=Math.sqrt(configAttrFirst.z);bubbleRadius=Math.round(sqrtBubbleZ*radiusFactor)*bubbleScale||0;bubbleRadiusVal=xAxis.getValue(bubbleRadius)-startValue;xReducedFirst=configAttrFirst.x-bubbleRadiusVal/2}if(secondDataChangeFlag===1){sqrtBubbleZ=Math.sqrt(configAttrLast.z);bubbleRadius=Math.round(sqrtBubbleZ*radiusFactor)*bubbleScale||0;bubbleRadiusVal=xAxis.getValue(bubbleRadius)-startValue;xReducedLast=configAttrLast.x-bubbleRadiusVal/2}firstDataChangeFlag=0;secondDataChangeFlag=0;if(xReducedFirst>xReduced){firstData=data[i];firstDataChangeFlag=1}if(xReducedLast<xReduced){lastData=data[i];secondDataChangeFlag=1}}if(firstData){dataConf=firstData.config;anchorRadius=dataConf.anchorProps.radius;showValue=dataConf.showValue;if(showValue){label=dataConf.displayValue;SmartLabel.useEllipsesOnOverflow(chartConfig.useEllipsesWhenOverflow);SmartLabel.setStyle(dataLabelStyle);labelDimStart=SmartLabel.getOriSize(label);labelWidth=rotateValues?labelDimStart.height:labelDimStart.width}if(dataConf.setValue!==null){xReduced=xAxis.getPixel(dataConf.setValue.x);if(reversexaxis){minPoint=xReduced-labelWidth*.5;labelSpace=endPixel-minPoint}else{minPoint=xReduced-labelWidth*.5;labelSpace=startPixel-minPoint}if(!reversexaxis&&xReduced-anchorRadius<=startPixel||reversexaxis&&xReduced-anchorRadius<=endPixel){anchorSpace=reversexaxis?endPixel-(xReduced-anchorRadius):startPixel-(xReduced-anchorRadius)}else{anchorSpace=0}}returnDimension.paddingLeft=mathMax(labelSpace,anchorSpace)}if(lastData){dataConf=lastData.config;showValue=dataConf.showValue;anchorRadius=dataConf.anchorProps.radius;if(showValue){label=dataConf.displayValue;SmartLabel.setStyle(dataLabelStyle);labelDimEnd=SmartLabel.getOriSize(label);labelWidth=rotateValues?labelDimEnd.height:labelDimEnd.width}if(dataConf.setValue!==null){xReduced=xAxis.getPixel(dataConf.setValue.x);minPoint=xReduced-startPixel+labelWidth*.5;labelSpace=minPoint-endPixel+startPixel;if(reversexaxis){labelSpace=minPoint}if(!reversexaxis&&xReduced+anchorRadius>=endPixel||reversexaxis&&xReduced+anchorRadius>=startPixel){anchorSpace=reversexaxis?xReduced+anchorRadius-startPixel:xReduced+anchorRadius-endPixel}else{anchorSpace=0}}returnDimension.paddingRight=mathMax(labelSpace,anchorSpace)}if(topMostData){dataConf=topMostData.config;anchorRadius=dataConf.anchorProps.radius||0;yAxisMax=yAxis.getPixel(yAxisMax);if(dataConf.setValue!==null){yReduced=yAxis.getPixel(dataConf.setValue.y);anchorSpace=pluckNumber(anchorRadius,0)+pluckNumber(dataConf.anchorProps.borderThickness,0)/2}if(yAxisMax-(yReduced-anchorSpace)>0){returnDimension.paddingTop=yAxisMax-(yReduced-anchorSpace)}else{returnDimension.paddingTop=0}}if(bottomMostData){dataConf=bottomMostData.config;anchorRadius=dataConf.anchorProps.radius||0;yAxisMin=yAxis.getPixel(yAxisMin);if(dataConf.setValue!==null){yReduced=yAxis.getPixel(dataConf.setValue.y);anchorSpace=pluckNumber(anchorRadius,0)+pluckNumber(dataConf.anchorProps.borderThickness,0)/2}if(yReduced+anchorSpace-yAxisMin>0){returnDimension.paddingBottom=yReduced+anchorSpace-yAxisMin}else{returnDimension.paddingBottom=0}}return returnDimension};_proto._addLegend=function _addLegend(){var symbolColor,mFillColor,mLineColor,dataset=this,chart=dataset.getFromEnv("chart"),conf=dataset.config,config,legendItem,legend=chart.getChildren("legend")[0],drawAnchors=pluckNumber(conf.drawanchors,1),marker={fillColor:getPointColor(conf.anchorbgcolor,HUNDREDSTRING),lineColor:{FCcolor:{color:conf.anchorbordercolor,alpha:conf.anchoralpha}},lineWidth:conf.anchorborderthickness},item3dlighting=legend.config.symbol3DLighting;if(item3dlighting){if(marker.fillcolor&&marker.fillcolor.FCcolor){symbolColor=extend2({},marker.fillcolor);symbolColor.FCcolor.alpha=HUNDREDSTRING}else{symbolColor=pluck(marker.fillColor)}}else{symbolColor={FCcolor:{color:pluck((mFillColor=marker.fillColor)&&(mFillColor.FCcolor&&mFillColor.FCcolor.color.split(COMMA)[0]||mFillColor)),angle:0,ratio:"0",alpha:"100"}}}config={enabled:conf.includeInLegend,type:dataset.type,drawLine:pluck(conf.drawLine,true),anchorSide:drawAnchors?conf.anchorsides:0,label:getFirstValue(dataset.config.JSONData.seriesname)};if(conf.includeinlegend){legendItem=legend.getItem(dataset.config.legendItemId);if(!legendItem){dataset.config.legendItemId=legend.createItem(dataset);legendItem=legend.getItem(dataset.config.legendItemId);dataset.addExtEventListener("fc-click",function(){legendItem.itemClickFn()},legendItem)}else{legendItem.configure({style:legend.config.itemStyle,hiddenStyle:legend.config.itemHiddenStyle,datasetVisible:legend.config.datasetVisible,hoverStyle:legend.config.itemHoverStyle})}legendItem.configure(config);legendItem.setStateCosmetics("default",{symbol:{fill:toRaphaelColor(symbolColor),rawFillColor:conf.anchorbgcolor,rawStrokeColor:conf.lineColor,stroke:toRaphaelColor(pluck((mLineColor=marker.lineColor)&&(mLineColor.FCcolor&&mLineColor.FCcolor.color.split(COMMA)[0]||mLineColor))),"stroke-width":conf.anchorborderthickness}});if(!dataset.getState("visible")){legendItem.setLegendState("hidden")}else{legendItem.removeLegendState("hidden")}}else if(dataset.config.legendItemId){legend.disposeItem(dataset.config.legendItemId)}};_proto.getDSGroupdef=function getDSGroupdef(){return UNDEF};_proto.trimData=function trimData(datasetJSON){if(!this.config.JSONData){return}var dataSet=this,config=dataSet.config,context=config&&config.context,prevCatlen=context&&context.prevCatlen,xAxis=dataSet.getFromEnv("xAxis"),currCatLen=xAxis.getTicksLen(),catDiff=prevCatlen-currCatLen,prevData=config.JSONData,prevDataLength=prevData.data&&prevData.data.length,currDataLength=datasetJSON.data&&datasetJSON.data.length||0,dataDiff=prevDataLength-currDataLength,diff,startIndex;if(catDiff>dataDiff){diff=catDiff;startIndex=currCatLen}else{diff=dataDiff;startIndex=currDataLength}if(diff>0){this.removeData(startIndex,diff,false)}};return ScatterDataset}(LineDataset);export default ScatterDataset;