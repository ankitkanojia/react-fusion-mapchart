import _inheritsLoose from"@babel/runtime/helpers/inheritsLoose";import BaseChart from"@fusioncharts/core/src/base-chart";import canvasFactory from"../../factories/canvas";import{addDep,getDep}from"@fusioncharts/core/src/dependency-manager";import Caption from"../../_internal/components/caption";import SubCaption from"../../_internal/components/sub-caption";import Background from"../../_internal/components/background";import ColorManager from"../../_internal/color-utils/colormanager";import NumberFormatter from"@fusioncharts/core/src/number-formatter";import{raiseEventGroup}from"@fusioncharts/core/src/event-api";import commonAnimation from"./common.animation";import{chartPaletteStr,getLinkAction,pluckNumber,pluck,BLANKSTRING,POSITION_BOTTOM,UNDEF,pluckFontSize,PXSTRING,setLineHeight,getFirstValue,pInt,getDashStyle,DASH_DEF,extend2,preDefStr,ROUND,POINTER,HAND,getMouseCoordinate,POSITION_MIDDLE,componentFactory,hasSVG,convertColor,parseConfiguration}from"@fusioncharts/core/src/lib";import domEvtHandler from"@fusioncharts/core/src/dom-event";import{ToolBar,Hamburger}from"@fusioncharts/core/src/toolbox";import{SymbolStore}from"@fusioncharts/core/src/toolbox/tools/helper";var Raphael=getDep("redraphael","plugin"),isVML=Raphael.type==="VML",mathMax=Math.max,mathMin=Math.min,mathRound=Math.round,MOUSEDOWN="mousedown",LINEAR="linear",TOOLTIP_SEP_CHAR=", ",COLOR_FFF="FFF",COLOR_666="666",BASE_FONT="Verdana, sans",eventMap={datalabelclick:true,connectorclick:true,categoryclick:true,processclick:true,milestoneclick:true,labelclick:true,dataplotclick:true},SEVENTYSTRING=preDefStr.SEVENTYSTRING,AUTO=preDefStr.AUTOSTRING,BOLD="bold",NORMAL="normal",POSITION_RIGHT="right",supportsPointer="onpointerover"in window.document,POSITION_START="start",POSITION_END="end",assign=function assign(){for(var _len=arguments.length,param=new Array(_len),_key=0;_key<_len;_key++){param[_key]=arguments[_key]}var src=param[0],trgts=param.slice(1);trgts.forEach(function(trgt){for(var key in trgt){if(trgt.hasOwnProperty(key)&&trgt[key]!==UNDEF){src[key]=trgt[key]}}});return src},createGroup=function createGroup(attrs,parentContainer,chart){var animationManager=chart.getFromEnv("animationManager");return animationManager.setAnimation({el:"group",attr:attrs,container:parentContainer,state:"appearing",component:chart,label:"group"})},_registerMouseDown=function _registerMouseDown(e){var config=e.data.config;config._containerMouseState=MOUSEDOWN;config._mdx1=e.clientX!==UNDEF?e.clientX:e.changedTouches&&e.changedTouches[0].clientX;config.mdy1=e.clientY!==UNDEF?e.clientY:e.changedTouches&&e.changedTouches[0].clientY;e.type==="touchstart"&&(config._touchStartedAt=(new Date).getTime())},_registerMouseMove=function _registerMouseMove(e){var config=e.data.config,x2=e.clientX!==UNDEF?e.clientX:e.changedTouches&&e.changedTouches[0].clientX,y2=e.clientY!==UNDEF?e.clientY:e.changedTouches&&e.changedTouches[0].clientY;if(Math.abs(config._mdx1-x2)>=2.5||Math.abs(config.mdy1-y2)>=2.5){e.data.config._containerMouseState=UNDEF}},_onContainerClickIOS=function _onContainerClickIOS(e){if((new Date).getTime()-e.data.config._touchStartedAt<500){setTimeout(function(){onContainerClick(e)})}},onContainerClick=function onContainerClick(e){var chart=e.data,fusionCharts=chart.getFromEnv("chartInstance"),oriEvent=e.originalEvent,config=chart.config,coordinate=getMouseCoordinate(chart.getFromEnv("chart-container"),oriEvent,chart),args;if(!fusionCharts.ref||config._containerMouseState==="mousemove"){return}args=extend2({height:fusionCharts.args.height,width:fusionCharts.args.width,pixelHeight:chart.getFromEnv("chartWidth"),pixelWidth:chart.getFromEnv("chartHeight"),id:fusionCharts.args.id,renderer:fusionCharts.args.renderer,container:fusionCharts.options.containerElement},coordinate);chart.fireChartInstanceEvent("chartclick",args);config.link&&(config.hotElemClicked?config.clickURLOverridesPlotLinks:true)&&chart.getFromEnv("linkClickFN").call({link:config.link});config.hotElemClicked=false},chartHoverManager=function chartHoverManager(e){var type=e.type,chart=e.data,listeners=chart.getFromEnv("eventListeners");if((type==="mouseover"||type==="touchstart")&&chart.config.mouseStateIn===false){chart.config.mouseStateIn=true;CommonAPI.onContainerRollOver(e);listeners.push(domEvtHandler.listen(isVML?document:window,"mouseover",CommonAPI.winMouseHover,chart))}else if(type==="mouseout"||type==="touchend"){chart.config.posOb=false}},toolbarPositionParser=function toolbarPositionParser(pos){var position=pos;switch(position){case"tr":case"rt":case"top right":case"right top":position="tr";break;case"br":case"rb":case"bottom right":case"right bottom":position="br";break;case"tl":case"lt":case"top left":case"left top":position="tl";break;case"bl":case"lb":case"bottom left":case"left bottom":position="bl";break;default:position="tr"}return position};function _createToolBox2(){var chart=this,iapi=this,rtConfig,config=chart.config,chartAttrs=chart.getFromEnv("chart-attrib"),toolBarType=config.toolbarVAlign==="t"?"chartMenuBar":"actionBar",removeTBType=config.toolbarVAlign==="t"?"actionBar":"chartMenuBar",toolBar,hamburgerMenu,toolConf=chart.getFromEnv("tool-config"),printEnabled=config.printOption.enabled;rtConfig=iapi.config.realTimeConfig||{};componentFactory(chart,ToolBar,removeTBType,0,[chartAttrs]);componentFactory(chart,ToolBar,toolBarType,1,[chartAttrs]);toolBar=chart.getChildren(toolBarType)[0];chart.addToEnv("toolbar",toolBar);SymbolStore.register("ContextIcon",function(posx,posy,rad){var x=posx,y=posy,r=rad*2,space=mathRound(r/4),halfWidth=mathRound(r/2)*.7,startX=x-halfWidth,endX=x+halfWidth,startY=y+space,endY=y-space;return["M",startX,y,"L",endX,y,"M",startX,startY,"L",endX,startY,"M",startX,endY,"L",endX,endY]});hamburgerMenu=toolBar.attachChild(Hamburger,"tool","hamburgerMenu-"+toolBar.getId()+"-"+chart.getId()+"-0");chart.addToEnv("hamburger",hamburgerMenu);hamburgerMenu.configure(Object.assign({},toolConf,{name:"ContextIcon"}));hamburgerMenu._mouseOutEvent||(hamburgerMenu._mouseOutEvent=function(){this.getChild("listContainer").hide()});hamburgerMenu._mouseOverEvent||(hamburgerMenu._mouseOverEvent=function(){this.getChild("listContainer").show()});hamburgerMenu.addEventListener("fc-mouseover",hamburgerMenu._mouseOverEvent);hamburgerMenu.addEventListener("fc-mouseout",hamburgerMenu._mouseOutEvent);if(printEnabled){hamburgerMenu.appendInMenu([{name:"Print",action:"click",handler:function handler(){chart.getFromEnv("chartInstance").print()}}])}iapi._setRTmenu&&iapi._setRTmenu(rtConfig.showRTmenuItem,rtConfig.useMessageLog)}function _drawDataset(){var iapi=this,canvas=iapi.getChildren("canvas")[0];canvas._mapChildren(function(child){child.syncDraw()})}function configurer(dataObj){var iapi=this;iapi.config.skipConfigureIteration={};iapi.parseChartAttr(dataObj);iapi.createComponent(dataObj);iapi._createToolBox();iapi.setTooltipStyle();iapi.configureChildren()}addDep({name:"commonAnimation",type:"animationRule",extension:commonAnimation});var CommonAPI=function(_BaseChart){_inheritsLoose(CommonAPI,_BaseChart);CommonAPI.getName=function getName(){return"CommonAPI"};var _proto=CommonAPI.prototype;_proto.plotEventHandler=function plotEventHandler(elem,event,evntName,eventArguments){if(event===void 0){event={}}var chart=this,eventType=event.type,eventName=evntName,coordinate=getMouseCoordinate(chart.getFromEnv("chart-container"),event,chart),eventArgs=elem&&elem.data("eventArgs")||eventArguments,args=extend2(coordinate,eventArgs),fireGroupEvent=chart.fireGroupEvent,env,linkClickFN,id=elem&&elem.data("groupId"),cancelHover=function cancelHover(c,a){event.FusionChartsPreventEvent=true};if("index"in args&&!("dataIndex"in args)){args.dataIndex=args.index}if("value"in args&&!("dataValue"in args)){args.dataValue=args.value}eventName=pluck(eventName,"dataplotclick").toLowerCase();if(eventName==="dataplotrollover"){event.FusionChartsPreventEvent=false;if(fireGroupEvent){raiseEventGroup(id,eventName,args,chart.getFromEnv("chartInstance"),UNDEF,UNDEF,cancelHover)}else{chart.fireChartInstanceEvent(eventName,args,UNDEF,UNDEF,cancelHover)}}else{if(fireGroupEvent&&!eventMap[eventName]){raiseEventGroup(id,eventName,args,chart.getFromEnv("chartInstance"))}else{chart.fireChartInstanceEvent(eventName,args)}}if((eventType==="fc-click"||eventType==="click"||eventType==="mouseup"||eventType==="touchend")&&/click/i.test(eventName)){env=chart.getFromEnv();linkClickFN=env&&env.linkClickFN;args.link&&linkClickFN&&linkClickFN.call({link:args.link},true)}};function CommonAPI(){var _this;_this=_BaseChart.call(this)||this;_this.addToEnv("stringConstants",{COMPONENT:"component",CANVAS:"canvas",CAPTION:"caption"});_this.addToEnv("getMouseCoordinate",getMouseCoordinate);_this._drawDataset=_drawDataset;_this.config.mouseStateIn=false;_this.registerFactory("canvas",canvasFactory);_this._firstConfigure=true;return _this}_proto.getName=function getName(){return"Cartesian"};_proto.preConfigure=function preConfigure(dataObj){var nf=this.getFromEnv("number-formatter");this.addToEnv("chart-attrib",dataObj.chart);nf?nf.configure():this.addToEnv("number-formatter",new NumberFormatter(this));_BaseChart.prototype.preConfigure.call(this,dataObj)};_proto.postConfigure=function postConfigure(dataObj){_BaseChart.prototype.postConfigure.call(this,dataObj);this._firstConfigure=false};_proto.setDefaults=function setDefaults(){_BaseChart.prototype.setDefaults.call(this);var nf=this.getFromEnv("number-formatter");nf&&nf.setDefaults&&nf.setDefaults()};_proto.getType=function getType(){return"chartAPI"};_proto.parseChartAttr=function parseChartAttr(dataObj){var iapi=this,jsonData=dataObj||iapi.getFromEnv("dataSource"),chartAttrs,is3D=iapi.config.is3D,palleteString=is3D?chartPaletteStr.chart3D:chartPaletteStr.chart2D,config,isBar=iapi.isBar,inCanfontFamily,inCanfontSize,inCancolor,fontSize,colorM=iapi.getFromEnv("color-manager"),style,zeroPlaneColor,zeroPlaneAlpha,inCanvasStyle,inCanLineHeight,dataLabelStyle,fontBdrColor,showCanvasBase;if(!colorM){colorM=new ColorManager(iapi);iapi.addToEnv("color-manager",colorM)}jsonData.chart=jsonData.chart||jsonData.graph||jsonData.map||{};delete jsonData.map;delete jsonData.graph;chartAttrs=jsonData.chart;!chartAttrs&&(chartAttrs=jsonData.chart={});config=iapi.config||(iapi.config={});parseConfiguration(chartAttrs,config,{},{showvalues:true,crosslinecolor:true,drawcrosslineontop:true,crosslinealpha:true,drawcrossline:true});config.showValues=pluckNumber(chartAttrs.showvalues,config.showvalues);config.viewPortConfig={scaleY:1,scaleX:1,x:0,y:0};iapi.addToEnv("tool-config",assign({},{scale:chartAttrs.toolbarbuttonscale,width:chartAttrs.toolbarbuttonwidth,height:chartAttrs.toolbarbuttonheight,radius:chartAttrs.toolbarbuttonradius,spacing:chartAttrs.toolbarbuttonspacing,marginTop:chartAttrs.toolbarbuttonmargintop,marginLeft:chartAttrs.toolbarbuttonmarginleft,marginRight:chartAttrs.toolbarbuttonmarginright,marginBottom:chartAttrs.toolbarbuttonmarginbottom,fill:chartAttrs.toolbarbuttoncolor,labelFill:chartAttrs.toolbarlabelcolor,symbolFill:chartAttrs.toolbarsymbolcolor,hoverFill:chartAttrs.toolbarbuttonhovercolor,stroke:chartAttrs.toolbarbuttonbordercolor,symbolStroke:chartAttrs.toolbarsymbolbordercolor,strokeWidth:chartAttrs.toolbarbuttonborderthickness,symbolStrokeWidth:chartAttrs.toolbarsymbolborderthickness,bSymbolPadding:chartAttrs.toolbarsymbolpadding,symbolHPadding:chartAttrs.toolbarsymbolhpadding,symbolVPadding:chartAttrs.toolbarsymbolvpadding,hAlign:chartAttrs.toolbarhalign,vAlign:chartAttrs.toolbarvalign}));if(is3D){if(isBar){config.xDepth=5;config.yDepth=5}else{config.xDepth=10;config.yDepth=10}config.showCanvasBase=showCanvasBase=Boolean(pluckNumber(chartAttrs.showcanvasbase,1));config.canvasBasePadding=pluckNumber(chartAttrs.canvasbasepadding,2);config.canvasBaseDepth=showCanvasBase?pluckNumber(chartAttrs.canvasbasedepth,10):0;config.canvasBgDepth=pluckNumber(chartAttrs.canvasbgdepth,3)}colorM&&colorM.configure();config.placeAxisLabelsOnTop=pluckNumber(chartAttrs.placexaxislabelsontop,0);config.enableAnimation=pluckNumber(chartAttrs.animation,chartAttrs.defaultanimation,1);config.showToolTip=pluckNumber(chartAttrs.showtooltip,1);config.printOption={enabled:pluckNumber(chartAttrs.printshowbutton,chartAttrs.showprintmenuitem,0)};config.drawCrossLineOnTop=pluckNumber(chartAttrs.drawcrosslineontop,1);style=config.style={};iapi.addToEnv("style",style);config.textDirection=chartAttrs.hasrtltext==="1"?"rtl":BLANKSTRING;style.inCanfontFamily=inCanfontFamily=pluck(chartAttrs.basefont,"Verdana,sans");style.inCanfontSize=inCanfontSize=pluckFontSize(chartAttrs.basefontsize,10);style.inCancolor=inCancolor=pluck(chartAttrs.basefontcolor,colorM.getColor(palleteString.baseFontColor));style.outCanfontFamily=pluck(chartAttrs.outcnvbasefont,inCanfontFamily);style.fontSize=fontSize=pluckFontSize(chartAttrs.outcnvbasefontsize,inCanfontSize);style.outCanfontSize=fontSize+PXSTRING;style.outCancolor=pluck(chartAttrs.outcnvbasefontcolor,inCancolor).replace(/^#? ([a-f0-9]+)/gi,"#$1");style.baseFontSize=inCanfontSize;style.inCanfontSize=inCanfontSize+PXSTRING;style.inCancolor=inCancolor.replace(/^#? ([a-f0-9]+)/gi,"#$1");style.inCanvasStyle=inCanvasStyle={fontFamily:inCanfontFamily,fontSize:inCanfontSize,color:inCancolor};style.inCanLineHeight=inCanLineHeight=setLineHeight(inCanvasStyle);fontBdrColor=getFirstValue(chartAttrs.valuebordercolor,BLANKSTRING);fontBdrColor=fontBdrColor?convertColor(fontBdrColor,pluckNumber(chartAttrs.valueborderalpha,chartAttrs.valuealpha,100)):BLANKSTRING;config.reverseXAxis=iapi.config.allowreversexaxis&&pluckNumber(chartAttrs.reversexaxis,0);config.showBorder=pluckNumber(chartAttrs.showborder,is3D?0:1);config.borderWidth=mathMax(config.showBorder?pluckNumber(chartAttrs.borderthickness,1):0,0);config.useplotgradientcolor=pluckNumber(chartAttrs.plotgradientcolor,config.useplotgradientcolor,0);config.valuefontbold=pluckNumber(chartAttrs.valuefontbold,config.valuefontbold);config.dataLabelStyle=dataLabelStyle={fontFamily:pluck(chartAttrs.valuefont,inCanfontFamily),fontSize:pluck(chartAttrs.valuefontsize,pInt(inCanfontSize,10))+PXSTRING,lineHeight:inCanLineHeight,color:convertColor(pluck(chartAttrs.valuefontcolor,inCancolor),pluckNumber(chartAttrs.valuefontalpha,chartAttrs.valuealpha,100)),fontWeight:config.valuefontbold?BOLD:NORMAL,fontStyle:pluckNumber(chartAttrs.valuefontitalic)?"italic":NORMAL,border:fontBdrColor||chartAttrs.valuebgcolor?pluckNumber(chartAttrs.valueborderthickness,1)+"px solid":BLANKSTRING,borderColor:fontBdrColor,borderThickness:pluckNumber(chartAttrs.valueborderthickness,1),borderPadding:pluckNumber(chartAttrs.valueborderpadding,2),borderRadius:pluckNumber(chartAttrs.valueborderradius,0),backgroundColor:chartAttrs.valuebgcolor?convertColor(chartAttrs.valuebgcolor,pluckNumber(chartAttrs.valuebgalpha,chartAttrs.valuealpha,100)):BLANKSTRING,borderDash:pluckNumber(chartAttrs.valueborderdashed,0)?getDashStyle(pluckNumber(chartAttrs.valueborderdashlen,4),pluckNumber(chartAttrs.valueborderdashgap,2)):DASH_DEF};setLineHeight(dataLabelStyle);config.legendposition=pluck(chartAttrs.legendposition,POSITION_BOTTOM);config.alignLegendWithCanvas=pluckNumber(chartAttrs.alignlegendwithcanvas,1);config.origMarginTop=pluckNumber(chartAttrs.charttopmargin,iapi.chartTopMargin,15);config.origMarginLeft=pluckNumber(chartAttrs.chartleftmargin,iapi.chartLeftMargin,15);config.origMarginBottom=pluckNumber(chartAttrs.chartbottommargin,iapi.chartBottomMargin,15);config.origMarginRight=pluckNumber(chartAttrs.chartrightmargin,iapi.chartRightMargin,15);config.origCanvasLeftMargin=pluckNumber(chartAttrs.canvasleftmargin,0);config.origCanvasRightMargin=pluckNumber(chartAttrs.canvasrightmargin,0);config.origCanvasTopMargin=pluckNumber(chartAttrs.canvastopmargin,0);config.origCanvasBottomMargin=pluckNumber(chartAttrs.canvasbottommargin,0);config.minChartWidthPercent=pluckNumber(chartAttrs.minchartwidth,iapi.minChartWidth,50)/100;config.minChartHeightPercent=pluckNumber(chartAttrs.minchartheight,iapi.minChartHeight,50)/100;config.minCanvasWidthPercent=pluckNumber(chartAttrs.mincanvaswidth,iapi.minCanvasWidth,60)/100;config.minCanvasHeightPercent=pluckNumber(chartAttrs.mincanvasheight,iapi.minCanvasHeight,30)/100;zeroPlaneColor=pluck(chartAttrs.zeroplanecolor,chartAttrs.divlinecolor,colorM.getColor(palleteString.divLineColor));zeroPlaneAlpha=pluck(chartAttrs.zeroplanealpha,chartAttrs.divlinealpha,colorM.getColor("divLineAlpha"));config.zeroPlaneColor=convertColor(zeroPlaneColor,zeroPlaneAlpha);config.zeroPlaneBorderColor=convertColor(pluck(chartAttrs.zeroplanebordercolor,zeroPlaneColor),pluckNumber(chartAttrs.zeroplaneshowborder,1)?zeroPlaneAlpha:0);config.zeroPlaneShowBorder=pluckNumber(chartAttrs.zeroplaneshowborder,1);config.realtimeEnabled=pluckNumber(chartAttrs.realtimeenabled,iapi.isRealTime);config.showLegend=pluckNumber(chartAttrs.showlegend,iapi.showLegend,1);config.link=chartAttrs.clickurl;config.transposeAxis=pluckNumber(iapi.transposeAxis,chartAttrs.transposeaxis,0);config.useEllipsesWhenOverflow=pluckNumber(chartAttrs.useellipseswhenoverflow,chartAttrs.useellipsewhenoverflow,1);config.drawTrendRegion=pluckNumber(chartAttrs.drawcrossline,0);config.plotcolorintooltip=pluckNumber(chartAttrs.plotcolorintooltip,iapi.config.singleseries?0:1);config.plotbinsize=mathMin(pluckNumber(chartAttrs.plotbinsize,iapi.plotbinsize,.5),1);config.labelbinsize=mathMin(pluckNumber(chartAttrs.labelbinsize,1),1);config.labelbinsize=config.plotbinsize>config.labelbinsize?config.plotbinsize:config.labelbinsize;config.enableMouseOutEvent=pluckNumber(chartAttrs.enablemouseoutevent,iapi.enableMouseOutEvent,1);config.plotSpacePercent=Math.max(pluckNumber(chartAttrs.plotspacepercent,iapi.plotSpacePercent),0);config.maxColWidth=Math.abs(pluckNumber(chartAttrs.maxcolwidth,50));config.maxBarHeight=Math.abs(pluckNumber(chartAttrs.maxbarheight,50));config.overlapColumns=pluckNumber(chartAttrs.overlapcolumns,chartAttrs.overlapbars,config.is3D?0:1);config.plotPaddingPercent=chartAttrs.plotpaddingpercent;config.tooltipgrayoutcolor=pluck(chartAttrs.tooltipgrayoutcolor,preDefStr.colors.AAAAAA);config.clickURLOverridesPlotLinks=pluckNumber(chartAttrs.clickurloverridesplotlinks,0);config.toolbarX=pluckNumber(chartAttrs.toolbarx);config.toolbarY=pluckNumber(chartAttrs.toolbary);config.toolbarPosition=toolbarPositionParser(pluck(chartAttrs.toolbarposition,"tr").toLowerCase());config.toolbarHAlign=(BLANKSTRING+chartAttrs.toolbarhalign).toLowerCase()==="left"?"l":config.toolbarPosition.charAt(1);config.toolbarVAlign=(BLANKSTRING+chartAttrs.toolbarvalign).toLowerCase()==="bottom"?"b":config.toolbarPosition.charAt(0);config.toolbarVMargin=pluckNumber(chartAttrs.toolbarvmargin,6);config.toolbarHMargin=pluckNumber(chartAttrs.toolbarhmargin,10);iapi.addToEnv("chartConfig",config);iapi.addToEnv("linkClickFN",getLinkAction(iapi.getFromEnv("dataSource"),iapi));iapi.addToEnv("dataLabelStyle",dataLabelStyle)};_proto.createComponent=function createComponent(){var iapi=this,config=iapi.config,skipConfigureIteration;skipConfigureIteration=config.skipConfigureIteration;iapi.createBaseComponent();iapi.getFromEnv("animationManager").setAnimationState(iapi._firstConfigure?"initial":"update");componentFactory(iapi,Caption,"caption");skipConfigureIteration.caption=true;componentFactory(iapi,SubCaption,"subCaption");skipConfigureIteration.subCaption=true;componentFactory(iapi,Background,"background");skipConfigureIteration.background=true;iapi._createConfigurableComponents&&iapi._createConfigurableComponents();if(iapi.config.realtimeEnabled){iapi._realTimeConfigure&&iapi._realTimeConfigure()}};_proto.configureChildren=function configureChildren(){var iapi=this;iapi._mapChildren(function(child){if(!child.getState("removed")&&iapi.config.skipConfigureIteration[child.getName()]){child.configure&&child.configure()}})};_proto._createToolBox=function _createToolBox(){_createToolBox2.call(this)};_proto.configureAttributes=function configureAttributes(dataObj){configurer.call(this,dataObj)};_proto.setTooltipStyle=function setTooltipStyle(){var chartConfig=this.config,toolTipController=this.getFromEnv("toolTipController");toolTipController.setStyle({backgroundColor:hasSVG?convertColor(chartConfig.tooltipbgcolor||"FFF",chartConfig.tooltipbgalpha||100):(chartConfig.tooltipbgcolor||"FFF").replace(/\s+/g,"").replace(/^#?([a-f0-9]+)/gi,"#$1"),color:(chartConfig.tooltipcolor||chartConfig.basefontcolor||"545454").replace(/\s+/g,"").replace(/^#?([a-f0-9]+)/gi,"#$1"),borderColor:hasSVG?convertColor(chartConfig.tooltipbordercolor||"666",chartConfig.tooltipborderalpha||100):(chartConfig.tooltipbordercolor||"666").replace(/\s+/g,"").replace(/^#?([a-f0-9]+)/gi,"#$1"),borderWidth:pluckNumber(chartConfig.tooltipborderthickness,1)+"px",showToolTipShadow:pluckNumber(chartConfig.showtooltipshadow,chartConfig.showshadow,1),borderRadius:pluckNumber(chartConfig.tooltipborderradius,0)+"px",fontSize:pluckNumber(chartConfig.basefontsize,10)+"px",fontFamily:chartConfig.basefont||this.getFromEnv("style").inCanfontFamily,padding:pluckNumber(chartConfig.tooltippadding||3)+"px"})};_proto.__setDefaultConfig=function __setDefaultConfig(){_BaseChart.prototype.__setDefaultConfig.call(this);var config=this.config;config.valuefontbold=0;config.stickytracking=1;config.usemessagelog=0;config.zeroplanethickness=UNDEF;config.animationeffect=LINEAR;config.showshadow=1;config.showhovereffect=UNDEF;config.plothovereffect=UNDEF;config.anchorhovereffect=UNDEF;config.plotborderdashed=UNDEF;config.stack100percent=UNDEF;config.showpercentvalues=UNDEF;config.showpercentintooltip=UNDEF;config.plotbordercolor=UNDEF;config.showtooltip=1;config.seriesnameintooltip=1;config.rotatevalues=0;config.minimizetendency=0;config.plotfillangle=270;config.valuepadding=2;config.useplotgradientcolor=1;config.plotborderthickness=1;config.plotfillalpha=SEVENTYSTRING;config.showvalues=1;config.valueposition=AUTO;config.drawcrossline=UNDEF;config.tooltipsepchar=TOOLTIP_SEP_CHAR;config.usedataplotcolorforlabels=0;config.placevaluesinside=0;config.showplotborder=1;config.use3dlighting=1;config.useroundedges=0;config.plotspacepercent=20;config.plotpaddingpercent=UNDEF;config.plotfillratio=UNDEF;config.maxcolwidth=50;config.plotborderdashlen=5;config.plotborderdashgap=4;config.useScaleRecursively=true;config.formatnumberscale=1;config.decimals=2;config.decimalprecision=10;config.tooltipbgcolor=COLOR_FFF;config.tooltipcolor=UNDEF;config.tooltipbordercolor=COLOR_666;config.tooltipbgalpha=100;config.tooltipborderthickness=1;config.showtooltipshadow=UNDEF;config.basefontsize=10;config.basefont=BASE_FONT;config.tooltipborderradius=0;config.tooltippadding=3;config.tooltipborderalpha=100;config.origw=UNDEF;config.origh=UNDEF};_proto.configure=function configure(dataObject){var chart=this,dataObj=dataObject;chart.sanitizeData(dataObj);chart.addToEnv("dataSource",dataObj);chart.fireEvent("internal.dataSanitized",{});dataObj=chart.getFromEnv("dataSource");_BaseChart.prototype.configure.call(this,dataObj)};_proto._checkInvalidData=function _checkInvalidData(){var iapi=this,dataObj=iapi.getFromEnv("dataSource"),chartInstance=iapi.getFromEnv("chartInstance");if(!iapi.isWidget&&!iapi.isMap&&!(dataObj.data&&dataObj.data.length!==0)&&!dataObj.dataset&&!dataObj.value&&!dataObj.lineset&&!dataObj.annotations&&!dataObj.category&&!(dataObj.tasks||dataObj.process)&&!dataObj.axis){chartInstance.__state.dataReady=false;chartInstance.jsVars.hasNativeMessage=true;chartInstance.jsVars.drawCount+=1;return true}};_proto._checkInvalidSpecificData=function _checkInvalidSpecificData(){var jsonData=this.getFromEnv("dataSource"),datasetsJSON=jsonData.dataset,categories=jsonData.categories;if(!datasetsJSON||!categories||categories.length===0||!categories[0].category){return true}};_proto.sanitizeData=function sanitizeData(dataObj){dataObj.chart=dataObj.chart||dataObj.graph||dataObj.map||{}};_proto.setChartEvents=function setChartEvents(){var chart=this,listeners=chart.getFromEnv("eventListeners"),dataSource=chart.getFromEnv("dataSource"),chartAttrs=dataSource&&dataSource.chart,canvas=chart.getFromEnv("paper")&&chart.getFromEnv("paper").canvas,container=chart.getFromEnv("chart-container"),enableMouseMove=chartAttrs&&pluckNumber(chartAttrs.enablechartmousemoveevent,0);if(!(chartAttrs||canvas)){return}domEvtHandler.unlisten(container,supportsPointer?"click":"touchend",supportsPointer?onContainerClick:_onContainerClickIOS);listeners.push(domEvtHandler.listen(container,"mousedown touchstart",_registerMouseDown,chart));listeners.push(domEvtHandler.listen(container,"mousemove touchmove",_registerMouseMove,chart));listeners.push(domEvtHandler.listen(container,supportsPointer?"click":"touchend",supportsPointer?onContainerClick:_onContainerClickIOS,chart));domEvtHandler.unlisten(canvas,"mouseover",chartHoverManager,chart);domEvtHandler.unlisten(canvas,"touchstart",chartHoverManager,chart);domEvtHandler.unlisten(canvas,"mouseout",chartHoverManager,chart);domEvtHandler.unlisten(canvas,"touchend",chartHoverManager,chart);listeners.push(domEvtHandler.listen(canvas,"mouseover touchstart mouseout touchend",chartHoverManager,chart));domEvtHandler.unlisten(container,"mousemove",CommonAPI.onContainerMouseMove,chart);domEvtHandler.unlisten(container,"touchmove",CommonAPI.onContainerMouseMove,chart);if(enableMouseMove){listeners.push(domEvtHandler.listen(container,"mousemove touchmove",CommonAPI.onContainerMouseMove,chart))}};_proto.get=function get(where,what){var place=this[where];return what?place&&place[what]:place};_proto.prepareAttributes=function prepareAttributes(){if(this.config.hasChartMessage){return}_BaseChart.prototype.prepareAttributes.call(this)};_proto.disposeChartStyleSheet=function disposeChartStyleSheet(){var chart=this,paper=chart.getFromEnv("paper");paper&&paper.cssClear()};_proto.createChartStyleSheet=function createChartStyleSheet(){var chart=this,paper=chart.getFromEnv("paper");paper.cssRender()};_proto._dispose=function _dispose(){var listeners=this.getFromEnv("eventListeners"),len=listeners&&listeners.length;while(len--){listeners[len].unlisten()}_BaseChart.prototype._dispose.call(this)};_proto._allocateSpace=function _allocateSpace(dimensions){var iapi=this,canvas=iapi.getChildren("canvas"),canvasConfig=canvas&&canvas[0].config,config=iapi.config,canvasHeight=config.canvasHeight,canvasWidth=config.canvasWidth,canvasTop,canvasLeft,availableHeight=config.availableHeight,availableWidth=config.availableWidth;canvasLeft=config.canvasLeft+=dimensions.left||0;canvasTop=config.canvasTop+=dimensions.top||0;canvasWidth=config.canvasWidth=mathMax(canvasWidth-((dimensions.left||0)+(dimensions.right||0)),0);canvasHeight=config.canvasHeight=mathMax(canvasHeight-((dimensions.top||0)+(dimensions.bottom||0)),0);config.availableHeight=mathMax(availableHeight-((dimensions.top||0)+(dimensions.bottom||0)),0);config.availableWidth=mathMax(availableWidth-((dimensions.left||0)+(dimensions.right||0)),0);config.canvasRight=canvasLeft+canvasWidth;config.canvasBottom=canvasTop+canvasHeight;if(canvasConfig){canvasConfig.canvasPaddingLeft=mathMax(canvasConfig.canvasPaddingLeft,dimensions.paddingLeft||0);canvasConfig.canvasPaddingRight=mathMax(canvasConfig.canvasPaddingRight,dimensions.paddingRight||0);canvasConfig.canvasPaddingTop=mathMax(canvasConfig.canvasPaddingTop,dimensions.paddingTop||0);canvasConfig.canvasPaddingBottom=mathMax(canvasConfig.canvasPaddingBottom,dimensions.paddingBottom||0)}canvas&&canvas[0].setDimension({top:canvasTop,left:canvasLeft,width:canvasWidth,height:canvasHeight})};_proto._fetchCaptionPos=function _fetchCaptionPos(centerX){var extraSpace,iapi=this,iapiConfig=iapi.config,totalWidth=iapiConfig.width,chartMenuBar=iapi.getChildren("chartMenuBar")&&iapi.getChildren("chartMenuBar")[0],chartMenuLogicalSpace=chartMenuBar?chartMenuBar.getLogicalSpace():{},toolBoxWidth=chartMenuLogicalSpace.width||0,caption=iapi.getChildren("caption")&&iapi.getChildren("caption")[0],captionConfig=caption.config,captionWidth=captionConfig.width,isHalign=iapiConfig.toolbarHAlign==="l",rightWidth=iapiConfig.width-centerX,availableWidth=isHalign?centerX:rightWidth,origMarginRight=iapiConfig.origMarginRight,origMarginLeft=iapiConfig.origMarginLeft,offsetX=isHalign?origMarginLeft:origMarginRight;if(captionConfig.align===POSITION_MIDDLE){extraSpace=availableWidth-captionWidth/2-offsetX-toolBoxWidth}else if(captionConfig.align==="start"){extraSpace=isHalign?-1:totalWidth-iapiConfig.canvasLeft-offsetX-captionWidth-toolBoxWidth+captionConfig.horizontalPadding}else{extraSpace=isHalign?totalWidth-(origMarginRight+origMarginLeft+toolBoxWidth+captionWidth):-1}return extraSpace};_proto._manageCaptionSpacing=function _manageCaptionSpacing(availableHeight,availableWidth){var iapi=this,caption=iapi.getChildren("caption")[0],dimension;dimension=caption.manageSpace(availableHeight,availableWidth);return dimension};_proto._manageChartMenuBar=function _manageChartMenuBar(availableHeight){var captionDimensions,iapi=this,iapiConfig=iapi.config,chartMenuBar=iapi.getChildren("chartMenuBar")&&iapi.getChildren("chartMenuBar")[0],hardCodedTBYPosition=iapiConfig.toolbarY!==UNDEF,chartMenuLogicalSpace=chartMenuBar?chartMenuBar.getLogicalSpace():{height:0,width:0},caption=iapi.getChildren("caption")&&iapi.getChildren("caption")[0],captionConfig=caption.config,isCaptionOnTop=captionConfig.isOnTop,chartCenterX=iapiConfig.width/2,canvasRight=iapiConfig.canvasRight,canvasCenterX=canvasRight?(iapiConfig.canvasLeft+canvasRight)/2:chartCenterX,extraSpace=0,availableWidth,centerX=captionConfig.alignWithCanvas?canvasCenterX:chartCenterX;hardCodedTBYPosition&&(chartMenuLogicalSpace.height=0);chartMenuBar&&chartMenuBar.setDimension({x:iapiConfig.toolbarX!==UNDEF?iapiConfig.toolbarX:pluckNumber(iapiConfig.toolbarHAlign==="l"?0:+iapiConfig.width),y:iapiConfig.toolbarY!==UNDEF?iapiConfig.toolbarY:pluckNumber(iapiConfig.toolbarVAlign==="t"?0:+iapiConfig.height),width:chartMenuLogicalSpace.width,height:chartMenuLogicalSpace.height});delete captionConfig._offsetHeight;availableWidth=captionConfig.alignWithCanvas?iapiConfig.canvasWidth:iapiConfig.width-iapiConfig.origMarginLeft-iapiConfig.origMarginRight;if(isCaptionOnTop){captionDimensions=iapi._manageCaptionSpacing(availableHeight,availableWidth);extraSpace=iapi._fetchCaptionPos(centerX);captionConfig._offsetHeight=extraSpace<0?chartMenuLogicalSpace.height:0;captionDimensions.top=extraSpace<0?pluckNumber(captionDimensions.top,0)+chartMenuLogicalSpace.height:mathMax(captionDimensions.top,chartMenuLogicalSpace.height);iapi._allocateSpace(captionDimensions)}else{iapi._allocateSpace({top:chartMenuLogicalSpace.height});captionDimensions=iapi._manageCaptionSpacing(availableHeight,availableWidth);iapi._allocateSpace(captionDimensions)}return{top:chartMenuLogicalSpace?mathMax(chartMenuLogicalSpace.height,captionDimensions.top):captionDimensions.top,bottom:captionDimensions.bottom}};_proto._manageSpace=function _manageSpace(){var iapi=this,canvas=iapi.getChildren("canvas")&&iapi.getChildren("canvas")[0],canvasConfig=canvas&&canvas.config,config=iapi.config,width=iapi.getFromEnv("chartWidth"),height=iapi.getFromEnv("chartHeight"),minCanvasWidth,minCanvasHeight,marginTop,marginLeft,marginBottom,marginRight,canvasHeight,canvasWidth,minChartHeight,minChartWidth,diff,sum;config.width=width;config.height=height;config.minChartHeight=minChartHeight=config.minChartHeightPercent*height;config.minChartWidth=minChartWidth=config.minChartWidthPercent*width;config.minCanvasWidth=minCanvasWidth=config.minCanvasWidthPercent*minChartWidth;config.minCanvasHeight=minCanvasHeight=config.minCanvasHeightPercent*minChartHeight;config.marginTop=marginTop=config.origMarginTop;config.marginLeft=marginLeft=config.origMarginLeft;config.marginBottom=marginBottom=config.origMarginBottom;config.marginRight=marginRight=config.origMarginRight;config.canvasMarginTop=config.origCanvasTopMargin;config.canvasMarginLeft=config.origCanvasLeftMargin;config.canvasMarginBottom=config.origCanvasBottomMargin;config.canvasMarginRight=config.origCanvasRightMargin;config.canvasHeight=canvasHeight=config.height-config.marginTop-config.marginBottom;config.canvasWidth=canvasWidth=config.width-config.marginLeft-config.marginRight;config.availableHeight=canvasHeight-minCanvasHeight;config.availableWidth=canvasWidth-minCanvasWidth;if(canvasHeight<minChartHeight){diff=height-minChartHeight;config.canvasHeight=minChartHeight;sum=marginTop+marginBottom;config.marginTop=diff*marginTop/sum;config.marginBottom=diff*marginBottom/sum;config.availableHeight=minChartHeight-minCanvasHeight}if(canvasWidth<minChartWidth){diff=width-minChartWidth;sum=marginRight+marginLeft;config.canvasWidth=minChartWidth;config.marginLeft=diff*marginLeft/sum;config.marginRight=diff*marginRight/sum;config.availableWidth=minChartWidth-minCanvasWidth}config.canvasLeft=config.marginLeft;config.canvasTop=config.marginTop;if(canvasConfig){canvasConfig.canvasPaddingLeft=mathMin(canvasConfig.origCanvasLeftPad,mathRound(.1*config.height));canvasConfig.canvasPaddingRight=mathMin(canvasConfig.origCanvasRightPad,mathRound(.1*config.height));canvasConfig.canvasPaddingTop=mathMin(canvasConfig.origCanvasTopPad,mathRound(.1*config.height));canvasConfig.canvasPaddingBottom=mathMin(canvasConfig.origCanvasBottomPad,mathRound(.1*config.height))}iapi._spaceManager()};_proto._preDraw=function _preDraw(){var iapi=this;iapi._mapChildren(function(child){if(!child.getState("removed")){child.preDraw&&child.preDraw()}});iapi._setAxisLimits&&iapi._setAxisLimits();iapi._createToolBoxGantt&&iapi._createToolBoxGantt()};_proto._clearTimers=function _clearTimers(){var iapi=this,realTimeConfig=iapi.config&&iapi.config.realTimeConfig,timers=iapi.config.timers,setTimeout=timers&&timers.setTimeout,setInterval=timers&&timers.setInterval,timer;realTimeConfig&&(realTimeConfig.refreshIntervalFlag=false);for(timer in setTimeout){clearTimeout(setTimeout[timer])}for(timer in setInterval){clearInterval(setInterval[timer])}};_proto.setChartCursor=function setChartCursor(){var chart=this,link=chart.config.link,style=chart.getFromEnv("paper").canvas.style;if(Raphael.svg){style.cursor=link?POINTER:"default"}else{chart.getFromEnv("paper").canvas.style.cursor=link?HAND:"default"}};_proto._createLayers=function _createLayers(){var iapi=this,parentGroup,animationManager=iapi.getFromEnv("animationManager");parentGroup=iapi.getContainer("parentgroup")||iapi.addContainer("parentgroup",animationManager.setAnimation({el:"group",attr:{name:"parentgroup"},component:iapi}));!iapi.getChildContainer("backgroundGroup")&&iapi.addChildContainer("backgroundGroup",createGroup({name:"background"},parentGroup,iapi));!iapi.getChildContainer("axisBottomGroup")&&iapi.addChildContainer("axisBottomGroup",createGroup({name:"axisbottom"},parentGroup,iapi));!iapi.getChildContainer("belowPlotGroup")&&iapi.addChildContainer("belowPlotGroup",createGroup({name:"belowplot"},parentGroup,iapi));!iapi.getChildContainer("plotGroup")&&iapi.addChildContainer("plotGroup",createGroup({name:"plots"},parentGroup,iapi));!iapi.getChildContainer("axisTopGroup")&&iapi.addChildContainer("axisTopGroup",createGroup({name:"axistop"},parentGroup,iapi));!iapi.getChildContainer("sumLabelsLayer")&&iapi.addChildContainer("sumLabelsLayer",createGroup({name:"sumlabels",class:"fusioncharts-datalabels"},parentGroup,iapi));!iapi.getChildContainer("datalabelsGroup")&&iapi.addChildContainer("datalabelsGroup",createGroup({name:"datalabel"},parentGroup,iapi));!iapi.getChildContainer("abovePlotGroup")&&iapi.addChildContainer("abovePlotGroup",createGroup({name:"aboveplot"},parentGroup,iapi));!iapi.getChildContainer("captionGroup")&&iapi.addChildContainer("captionGroup",createGroup({name:"caption"},parentGroup,iapi));!iapi.getChildContainer("defaultGroup")&&iapi.addChildContainer("defaultGroup",createGroup({name:"chartdefault"},parentGroup,iapi));!iapi.getChildContainer("defaultShadowGroup")&&iapi.addChildContainer("defaultShadowGroup",createGroup({name:"chartdefault-shadow"},parentGroup,iapi));!iapi.getChildContainer("trackerGroup")&&iapi.addChildContainer("trackerGroup",createGroup({name:"tracker"},parentGroup,iapi));!iapi.getChildContainer("toolbar-master")&&iapi.addChildContainer("toolbar-master",createGroup({name:"toolbar-master"},parentGroup,iapi));!iapi.getChildContainer("logoGroup")&&iapi.addChildContainer("logoGroup",animationManager.setAnimation({el:"group",attr:{name:"logo"},component:iapi}))};_proto._setDataLabelStyle=function _setDataLabelStyle(){var iapi=this,style=iapi.config.dataLabelStyle,labelCSS={fontFamily:style.fontFamily,fontSize:style.fontSize,fontWeight:style.fontWeight,fontStyle:style.fontStyle},datalabelsGroup=iapi.getChildContainer("datalabelsGroup");datalabelsGroup.css(labelCSS)};_proto._manageCaptionPosition=function _manageCaptionPosition(){var iapi=this,chartConfig=iapi.config,components=iapi.getChildren(),caption=components.caption&&components.caption[0],subCaption=components.subCaption&&components.subCaption[0],captionConfig=caption.config,widgetValueHeight=captionConfig.widgetValueHeight||0,subCaptionConfig=subCaption.config,captionX,captionY,subCaptionY,canvasWidth=chartConfig.canvasWidth,capAlign=captionConfig.align,hasCaption=captionConfig.text,alignWtCanvas=captionConfig.alignWithCanvas,hPadding=captionConfig.horizontalPadding,width=chartConfig.width,canvasLeft=chartConfig.canvasLeft,canvasRight=chartConfig.canvasRight,marginRight=chartConfig.marginRight,marginLeft=chartConfig.marginLeft,marginTop=chartConfig.marginTop,canvasCentre=(mathRound(canvasLeft)||0)+pluckNumber(canvasWidth,width)/2,interCaptionGap=2,captionLineHeight=captionConfig.height,subCaptionLineHeight=subCaptionConfig.height,legendConfig=components.legend&&components.legend[0]&&components.legend[0].config||{},legendHeight=legendConfig.height||0,legendPadding=legendConfig.legendPadding||0,legendPos=chartConfig.legendposition,gradientLegend=iapi.getFromEnv("gLegend")||{},gradientLegendHeight=0,showLegendAttr=!!(gradientLegend.conf||{}).showLegend,borderWidth=iapi.config.borderWidth,actionBar=components.actionBar,actionBarHeight=0,actionBarSpace;if(!legendConfig.isActive){legendHeight=0}if(showLegendAttr&&iapi.config.gLegendEnabled){gradientLegendHeight=gradientLegend.getLogicalSpace().height}switch(capAlign){case POSITION_END:captionX=alignWtCanvas?canvasRight-hPadding:width-hPadding;break;case POSITION_START:captionX=alignWtCanvas?canvasLeft+hPadding:hPadding;break;default:captionX=alignWtCanvas?canvasCentre:marginLeft+(width-marginLeft-marginRight)*.5||width/2}if(captionConfig.isOnTop){captionY=(borderWidth||0)+(marginTop||0)}else{if(legendPos.toLowerCase()===POSITION_RIGHT){legendPadding=0;legendHeight=0;gradientLegendHeight=0}if(actionBar){actionBarSpace=actionBar[0].getLogicalSpace&&actionBar[0].getLogicalSpace()||{};actionBarHeight=actionBarSpace.height;if(actionBarHeight===UNDEF||actionBarHeight===Infinity||actionBarHeight<0){actionBarHeight=0}}captionY=iapi.config.height-iapi.config.marginBottom-captionLineHeight-(subCaptionLineHeight||0)-(borderWidth||0)-(legendPadding||0)-(legendHeight||0)-gradientLegendHeight-widgetValueHeight-actionBarHeight}captionY+=captionConfig._offsetHeight||0;caption.setDimention({x:captionX,y:captionY});subCaptionY=hasCaption?captionY+captionLineHeight+interCaptionGap:captionY||marginTop||0;subCaption.setDimention({x:captionX,y:subCaptionY})};_proto.resizeCanvas=function resizeCanvas(){var iapi=this,paper=iapi.getFromEnv("paper"),config=iapi.config,animationManager=iapi.getFromEnv("animationManager"),width=iapi.getFromEnv("chartWidth"),height=iapi.getFromEnv("chartHeight");if(!hasSVG&&(config._prevWidth||config._prevHeight)){paper.setSize(config._prevWidth,config._prevHeight)}animationManager.setAnimation({el:paper,attr:{width:width,height:height},component:iapi})};_proto._updateVisuals=function _updateVisuals(){var iapi=this,coreOptions=iapi.getFromEnv("core-options"),paper=iapi.getFromEnv("paper"),config=iapi.config,width=iapi.getFromEnv("chartWidth"),height=iapi.getFromEnv("chartHeight");if(coreOptions&&!coreOptions._SVGDefinitionURLUpdated){if(/^\s*absolute\s*$/i.test(coreOptions.SVGDefinitionURL)){Raphael._url=(Raphael._g&&Raphael._g.win||window).location.href.replace(/#.*?$/,BLANKSTRING)}coreOptions._SVGDefinitionURLUpdated=true}if(!paper){paper=new Raphael(iapi.getFromEnv("chart-container"),width,height);paper.setHTMLClassName("fusioncharts-div");iapi.addToEnv("paper",paper);paper.setConfig("stroke-linecap",ROUND);iapi.setChartEvents()}else{iapi.resizeCanvas()}config._prevWidth=width;config._prevHeight=height;iapi.setChartCursor();iapi._createLayers();iapi._setDataLabelStyle();iapi._drawCreditLabel()};_proto.allocateDimensionOfChartMenuBar=function allocateDimensionOfChartMenuBar(){var iapi=this,config=iapi.config,toolBar=iapi.getFromEnv("toolbar"),tbConfig=toolBar.config,hDirection=tbConfig.hDirection,vDirection=tbConfig.vDirection,logicalSpace=toolBar.getLogicalSpace(),_toolBar$getDimension=toolBar.getDimension(),y=_toolBar$getDimension.y,x=_toolBar$getDimension.x;if(config.toolbarVAlign==="t"){y+=config.toolbarVMargin*vDirection+mathMin(0,logicalSpace.height*vDirection);x+=config.toolbarHMargin*hDirection-mathMax(0,logicalSpace.width*hDirection);x=config.toolbarHAlign==="l"?x+logicalSpace.width:x-logicalSpace.width}else{y=config.height-config.marginBottom-logicalSpace.height;x=config.toolbarVAlign==="b"&&config.toolbarHAlign==="r"?config.width-config.marginRight-logicalSpace.width:config.marginLeft}config.toolbarX!==UNDEF&&(x=config.toolbarX);config.toolbarY!==UNDEF&&(y=config.toolbarY);toolBar.setDimension({x:x,y:y,width:logicalSpace.width,height:logicalSpace.height});toolBar.manageSpace()};_proto.draw=function draw(){var iapi=this,chartObj=iapi.getFromEnv("chartInstance");if(iapi.config.hasChartMessage){iapi._hide();iapi.resizeCanvas();iapi.drawChartMessage();iapi.fireChartInstanceEvent("nodatatodisplay",{},[chartObj.id]);chartObj.jsVars.drawCount+=1;chartObj.__state.dataReady=false;chartObj.jsVars.hasNativeMessage=true}else{iapi._hideChartMessage();iapi._clearTimers&&iapi._clearTimers();iapi.config.plotOverFlow=false;iapi._show();iapi._updateVisuals();iapi.setState("initiated",true);chartObj.jsVars.drawCount+=1;chartObj.jsVars.hasNativeMessage=false}};_proto.manageSpace=function manageSpace(){var iapi=this;if(iapi.config.hasChartMessage){iapi.getChildren("chartMessage")[0].manageSpace();return}iapi._preDraw();iapi.addToolbar&&iapi.addToolbar();iapi._manageSpace();iapi._postSpaceManagement&&iapi._postSpaceManagement()};_proto._show=function _show(){this.getContainer("parentgroup")&&this.getContainer("parentgroup").show()};_proto._manageActionBarSpace=function _manageActionBarSpace(){var iapi=this,config=iapi.config,actionBar=iapi.getChildren("actionBar"),actionBarSpace=actionBar&&actionBar[0]&&actionBar[0].getLogicalSpace()||{},actionBarHeight=actionBarSpace.height||0;config.actionBarHeight=actionBarHeight;return{bottom:actionBarHeight}};_proto._hide=function _hide(){this.getContainer("parentgroup")&&this.getContainer("parentgroup").hide()};CommonAPI.onContainerMouseMove=function onContainerMouseMove(e){var chart=e.data,fusionCharts=chart.getFromEnv("chartInstance"),oriEvent=e.originalEvent,coordinate=getMouseCoordinate(chart.getFromEnv("chart-container"),oriEvent,chart),args;if(!fusionCharts.ref){return}args=extend2({height:fusionCharts.args.height,width:fusionCharts.args.width,pixelHeight:chart.getFromEnv("chartWidth"),pixelWidth:chart.getFromEnv("chartHeight"),id:fusionCharts.args.id,renderer:fusionCharts.args.renderer,container:fusionCharts.options.containerElement},coordinate);chart.fireChartInstanceEvent("chartMouseMove",args)};CommonAPI.onContainerRollOver=function onContainerRollOver(e){var chart=e.data,fusionCharts=chart.getFromEnv("chartInstance"),oriEvent=e.originalEvent,coordinate=getMouseCoordinate(chart.getFromEnv("chart-container"),oriEvent,chart),args;if(!fusionCharts.ref){return}args=extend2({height:fusionCharts.args.height,width:fusionCharts.args.width,pixelHeight:chart.getFromEnv("chartWidth"),pixelWidth:chart.getFromEnv("chartHeight"),id:fusionCharts.args.id,renderer:fusionCharts.args.renderer,container:fusionCharts.options.containerElement},coordinate);chart.fireChartInstanceEvent("chartRollOver",args)};CommonAPI.onContainerRollOut=function onContainerRollOut(e){var chart=e.chart,fusionCharts=chart.getFromEnv("chartInstance"),oriEvent=e.event,coordinate=getMouseCoordinate(chart.getFromEnv("chart-container"),oriEvent,chart),args;if(!fusionCharts.ref){return}args=extend2({height:fusionCharts.args.height,width:fusionCharts.args.width,pixelHeight:chart.getFromEnv("chartWidth"),pixelWidth:chart.getFromEnv("chartHeight"),id:fusionCharts.args.id,renderer:fusionCharts.args.renderer,container:fusionCharts.options.containerElement},coordinate);chart.fireChartInstanceEvent("chartRollOut",args)};CommonAPI.winMouseHover=function winMouseHover(e){var event=e.originalEvent,tgt=event.target||event.originalTarget||event.srcElement||event.relatedTarget||event.fromElement,chart=e.data,paper=chart.getFromEnv("paper"),eve={chart:chart,event:e.originalEvent};if(isVML){if(!paper.getById(tgt.parentNode.raphaelid)){CommonAPI.onContainerRollOut(eve);chart.config.mouseStateIn=false;domEvtHandler.unlisten(document,"mouseover",CommonAPI.winMouseHover)}}else{if(!tgt.viewportElement){chart.config.mouseStateIn=false;CommonAPI.onContainerRollOut(eve);domEvtHandler.unlisten(window,"mouseover",CommonAPI.winMouseHover)}}};return CommonAPI}(BaseChart);export default CommonAPI;export{_drawDataset,_createToolBox2 as _createToolBox,configurer};