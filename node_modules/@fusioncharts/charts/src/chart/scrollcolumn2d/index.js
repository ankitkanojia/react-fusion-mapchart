import _inheritsLoose from"@babel/runtime/helpers/inheritsLoose";import MScolumn2D from"../mscolumn2d";import ColumnDataset from"../../dataset/column";import Columngroup from"../../dataset/groups/column-multiseries";import{pluckNumber}from"@fusioncharts/core/src/lib";import{scrollTo}from"../_internal/utils/scroll-apis";var mathFloor=Math.floor,UNDEF,CHART_STR="Scrollable Multi-series Column Chart",COLUMN_STR="column",PLOT_STR="plot";function _setAxisScale2(){var iapi=this,config=iapi.config,xAxis=iapi.getChildren("xAxis")[0],catCount=xAxis.getTicksLen(),jsonData=iapi.getFromEnv("dataSource"),chartAttr=jsonData.chart,chartWidth=config.width,xAxisMin,xAxisMax,minVisiblePlots=2,numOfColumnSeries=0,totalNumPoint,visibleRange,xAxisLimit,scrollToEnd=config.scrollToEnd,numVisiblePlot=pluckNumber(chartAttr.numvisibleplot,mathFloor(chartWidth/iapi.avgScrollPointWidth));iapi.iterateComponents(function(child){if(child.getType&&child.getType()==="dataset"){if(child.getName&&child.getName()==="column"){!child.getState("removed")&&numOfColumnSeries++}}});if(iapi.config.isstacked){numOfColumnSeries=1}numOfColumnSeries=numOfColumnSeries||1;totalNumPoint=catCount*numOfColumnSeries;var _xAxis$getVisibleConf=xAxis.getVisibleConfig();xAxisMax=_xAxis$getVisibleConf.maxValue;xAxisMin=_xAxis$getVisibleConf.minValue;if(numVisiblePlot>=minVisiblePlots&&numVisiblePlot<totalNumPoint){visibleRange=numVisiblePlot/numOfColumnSeries;xAxis.setScrollType("always");if(scrollToEnd){xAxisMin=xAxisMax-visibleRange}else{xAxisMax=xAxisMin+visibleRange}if(xAxisMin===0){xAxisMax=xAxisMax-1}xAxis.setVisibleConfig(xAxisMin,xAxisMax)}else{xAxisLimit=xAxis.getLimit();xAxis.setVisibleConfig(xAxisLimit.min,xAxisLimit.max);xAxis.setScrollType("none")}}function _resetViewPortConfig2(){var iapi=this;iapi.config.viewPortConfig={scaleX:1,scaleY:1,x:0,y:0}}function _configurer(){var chart=this,jsonData=chart.getFromEnv("dataSource"),chartAttr=jsonData.chart,chartConfig;chartConfig=chart.config;chartConfig.scrollToEnd=pluckNumber(chartAttr.scrolltoend,0);chartConfig.lastScrollPosition=UNDEF}var ScrollColumn2D=function(_MScolumn2D){_inheritsLoose(ScrollColumn2D,_MScolumn2D);ScrollColumn2D.getName=function getName(){return"ScrollColumn2D"};ScrollColumn2D.includeInputOptions=function includeInputOptions(){return["SwipeGesture"]};function ScrollColumn2D(){var _this;_this=_MScolumn2D.call(this)||this;_this.tooltipConstraint=PLOT_STR;_this.canvasborderthickness=1;_this.avgScrollPointWidth=40;_this.hasScroll=true;_this.defaultPlotShadow=1;_this.binSize=0;_this.eiMethods.scrollTo=scrollTo;return _this}var _proto=ScrollColumn2D.prototype;_proto.getName=function getName(){return"ScrollColumn2D"};_proto.__setDefaultConfig=function __setDefaultConfig(){_MScolumn2D.prototype.__setDefaultConfig.call(this);var config=this.config;config.defaultDatasetType=COLUMN_STR;config.showzeroplaneontop=1;config.friendlyName=CHART_STR};_proto.configureAttributes=function configureAttributes(dataObj){_MScolumn2D.prototype.configureAttributes.call(this,dataObj);_configurer.call(this,dataObj)};_proto._setAxisScale=function _setAxisScale(){_setAxisScale2.call(this)};_proto.parseChartAttr=function parseChartAttr(dataObj){_MScolumn2D.prototype.parseChartAttr.call(this,dataObj)};_proto._resetViewPortConfig=function _resetViewPortConfig(){_resetViewPortConfig2.call(this)};_proto.getDSdef=function getDSdef(){return ColumnDataset};_proto.getDSGroupdef=function getDSGroupdef(){return Columngroup};return ScrollColumn2D}(MScolumn2D);export default ScrollColumn2D;export{_setAxisScale2 as _setAxisScale,_resetViewPortConfig2 as _resetViewPortConfig,_configurer as configurer};