import{datasetFactory,componentFactory}from"@fusioncharts/core/src/lib";import ColumnMultiSeriesGroup from"../dataset/groups/column-multiseries";export default function(chart){var jsonData=chart.getFromEnv("dataSource"),pDatasetsJSON=jsonData.dataset,pLength=pDatasetsJSON&&pDatasetsJSON.length,i,length,prevLength=0,datasetsJSON,canvas=chart.getChildren("canvas")[0],vCanvas=canvas.getChildren("vCanvas")[0],indices,stackGroups,stackConf=[],stackGroupParent;if(!pDatasetsJSON){chart.setChartMessage();return}componentFactory(vCanvas,ColumnMultiSeriesGroup,"multiSeriesGroup_column");stackGroupParent=vCanvas.getChildren("multiSeriesGroup_column")[0];for(i=0;i<pLength;i++){stackConf.push(pDatasetsJSON[i].dataset)}componentFactory(stackGroupParent,chart.getDSGroupdef(),"stackedGroup_column",pLength,stackConf);stackGroups=stackGroupParent.getChildren("stackedGroup_column");for(i=0;i<stackGroups.length;i++){if(stackGroups[i].getState("removed")!==true){datasetsJSON=pDatasetsJSON[i].dataset;if(!datasetsJSON){chart.setChartMessage();return}length=datasetsJSON&&datasetsJSON.length;indices=Array(length).fill(i*prevLength).map(function(n,j){return n+j});datasetFactory(stackGroups[i],chart.getDSdef(),"dataset_column",length,datasetsJSON,indices);prevLength=length}}chart.config._lastDatasetIndex=indices[indices.length-1]}