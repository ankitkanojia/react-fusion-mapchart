import CreateSheets from"./xlgenerator/spreadsheet";import{getStyles,createWorkBookRel}from"./xlgenerator/xlutil";import JSZip from"../_internal/vendors/jszip/dist/jszip";import{BLANKSTRING,UNDEF}from"@fusioncharts/core/src/lib";function exportJSONtoEXCEL(obj){var sh=new CreateSheets,zip,xl;sh.addSheet("Exported Data");var cellValue=BLANKSTRING;for(var rowindex=0;rowindex<obj.length;rowindex++){for(var columnindex=0;columnindex<obj[rowindex].length;columnindex++){cellValue=obj[rowindex][columnindex];if(typeof cellValue==="object"&&cellValue.value!==UNDEF)cellValue=cellValue.value;else if(cellValue!==UNDEF&&cellValue.length);else cellValue="";sh.createCell({sheet:0,row:rowindex,column:columnindex,value:cellValue})}}zip=new JSZip;zip.file("_rels/.rels",createWorkBookRel());xl=zip.folder("xl");xl.file("workbook.xml",sh.createWorkBook());xl.file("styles.xml",getStyles());xl.file("_rels/workbook.xml.rels",sh.createworkBookRels());zip.file("[Content_Types].xml",sh.createContentType());sh.fileSheets(xl);return zip.generateAsync({type:"blob",mimeType:"application/vnd.ms-excel"})}export default{extension:exportJSONtoEXCEL,name:"ExcelExport",type:"extension",requiresFusionCharts:false};