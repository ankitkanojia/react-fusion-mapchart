import _inheritsLoose from"@babel/runtime/helpers/inheritsLoose";import{SmartRenderer}from"@fusioncharts/core/src/component-interface";import{pluck,pluckNumber,UNDEF}from"@fusioncharts/core/src/lib";import{isMacro,solveEquation,parseEquation,cleanMacro,getScaledVal}from"../utils";var AnnotationBase=function(_SmartRenderer){_inheritsLoose(AnnotationBase,_SmartRenderer);function AnnotationBase(){return _SmartRenderer.apply(this,arguments)||this}var _proto=AnnotationBase.prototype;_proto.getType=function getType(){return"shape"};_proto._setConfig=function _setConfig(key,value){this.config[key]=value};_proto._getConfig=function _getConfig(configName){if(configName===void 0){configName=""}return configName===""?this.config:this.config[configName]};_proto.getElement=function getElement(){var shapeConfig=this.config;return this.getGraphicalElement(shapeConfig.id,shapeConfig.animationLabel)};_proto.getBounds=function getBounds(){return this.getElement().getBBox()};_proto.data=function data(key,value){var component=this;if(key&&typeof key==="string"){if(value!==UNDEF){!component._data&&(component._data={});component._data[key]=value}else{return component._data&&component._data[key]}}};_proto.parseAndSetAttribute=function parseAndSetAttribute(){var shape=this,rawGroupConfig=shape.rawConfig,snapPoints=shape.getFromEnv("snapPoints"),recalculatingAttrs={x:pluck(rawGroupConfig.x,rawGroupConfig.xPos,0),y:pluck(rawGroupConfig.y,rawGroupConfig.yPos,0),toX:pluck(rawGroupConfig.toX),toY:pluck(rawGroupConfig.toY)},calculatedAttrs=shape.config.calculatedAttrs={},groupCalculatedAttrs,attr,scale=shape.getScaleInfo();for(var key in recalculatingAttrs){if(recalculatingAttrs.hasOwnProperty(key)){attr=recalculatingAttrs[key];if(typeof attr!=="undefined"){attr=attr.toString();scale.axis=key;if(isMacro(attr)){calculatedAttrs[key]=solveEquation(parseEquation(cleanMacro(attr.toLowerCase()),snapPoints,scale))}else{calculatedAttrs[key]=solveEquation(parseEquation(cleanMacro(attr.toLowerCase()),snapPoints));pluckNumber(rawGroupConfig.autoscale,rawGroupConfig.autoScale,1)&&(calculatedAttrs[key]=getScaledVal(calculatedAttrs[key],scale))}}}}if(shape.config.elementType!=="group"){groupCalculatedAttrs=shape.getLinkedParent().config.calculatedAttrs;calculatedAttrs.x=calculatedAttrs.x+(groupCalculatedAttrs.x||0);calculatedAttrs.y=calculatedAttrs.y+(groupCalculatedAttrs.y||0);if(!isNaN(Number(calculatedAttrs.toX))){calculatedAttrs.toX+=groupCalculatedAttrs.x||0}else{calculatedAttrs.toX=calculatedAttrs.x}if(!isNaN(Number(calculatedAttrs.toY))){calculatedAttrs.toY+=groupCalculatedAttrs.y||0}}shape.updateAttr()};_proto.getAttribute=function getAttribute(configName){if(configName===void 0){configName=""}return configName===""?this.rawConfig:this.rawConfig[configName]};_proto.show=function show(){var shape=this,inputJSON=Object.assign({},shape.rawConfig);inputJSON.isVisible=true;shape.setData(inputJSON)};_proto.hide=function hide(){var shape=this,inputJSON=Object.assign({},shape.rawConfig);inputJSON.isVisible=false;shape.setData(inputJSON)};return AnnotationBase}(SmartRenderer);export default AnnotationBase;