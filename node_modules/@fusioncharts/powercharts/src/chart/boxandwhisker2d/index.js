import _assertThisInitialized from"@babel/runtime/helpers/assertThisInitialized";import _inheritsLoose from"@babel/runtime/helpers/inheritsLoose";import{COMMA,pluck,preDefStr,attrTypeNum,pluckNumber,HUNDREDSTRING,setAttribDefs}from"@fusioncharts/core/src/lib";import extent from"@fusioncharts/utils/src/array/extent";import MSColumn2D from"@fusioncharts/charts/src/chart/mscolumn2d";import BoxAndWhiskerDataset from"../../dataset/boxandwhisker";import datasetFactory from"../../factories/boxandwhisker-dataset";import BoxAndWhiskerMultiSeriesGroup from"../../dataset/groups/boxandwhisker-multiseries";setAttribDefs&&setAttribDefs({whiskerslimitswidthratio:{type:attrTypeNum,pAttr:"whiskerslimitswidthratio"},outliersupperrangeratio:{type:attrTypeNum,pAttr:"outliersupperrangeratio"},outlierslowerrangeratio:{type:attrTypeNum,pAttr:"outlierslowerrangeratio"},showalloutliers:{type:attrTypeNum,pAttr:"showalloutliers"},showmean:{type:attrTypeNum,pAttr:"showmean"},showsd:{type:attrTypeNum,pAttr:"showsd"},showmd:{type:attrTypeNum,pAttr:"showmd"},showqd:{type:attrTypeNum,pAttr:"showqd"},showminvalues:{type:attrTypeNum,pAttr:"showminvalues"},showmaxvalues:{type:attrTypeNum,pAttr:"showmaxvalues"},showq1values:{type:attrTypeNum,pAttr:"showq1values"},showq3values:{type:attrTypeNum,pAttr:"showq3values"},showmedianvalues:{type:attrTypeNum,pAttr:"showmedianvalues"}});var UNDEF,POLYGON=preDefStr.POLYGON,COLOR_000000=preDefStr.colors.c000000,BOXANDWHISKER_2D="boxandwhisker2d",COLON_STR=": ";var BoxAndWhisker2D=function(_MSColumn2D){_inheritsLoose(BoxAndWhisker2D,_MSColumn2D);BoxAndWhisker2D.getName=function getName(){return"BoxAndWhisker2D"};var _proto=BoxAndWhisker2D.prototype;_proto.getName=function getName(){return"BoxAndWhisker2D"};function BoxAndWhisker2D(){var _this;_this=_MSColumn2D.call(this)||this;var iapi=_assertThisInitialized(_this);iapi.maxColWidth=+Infinity;iapi.useErrorAnimation=1;iapi.avoidCrispError=0;iapi.plotSpacePercent=20;iapi.useplotgradientcolor=1;iapi.fireGroupEvent=true;_this.registerFactory("dataset",datasetFactory,["vCanvas"]);return _this}_proto.__setDefaultConfig=function __setDefaultConfig(){_MSColumn2D.prototype.__setDefaultConfig.call(this);var config=this.config;config.decimals=2;config.defaultDatasetType=BOXANDWHISKER_2D;config.showplotborder=1;config.plotborderdashlen=5;config.plotborderdashgap=4;config.plotfillalpha=HUNDREDSTRING;config.useroundedges=0;config.plotborderthickness=1;config.showvalues=1;config.valuepadding=2;config.decimals=2;config.showtooltip=1;config.maxcolwidth=50;config.rotatevalues=0;config.use3dlighting=1;config.whiskerslimitswidthratio=40;config.outliersupperrangeratio=0;config.outlierslowerrangeratio=0;config.showalloutliers=0;config.showmean=0;config.showsd=0;config.showmd=0;config.showqd=0;config.showminvalues=1;config.showmaxvalues=1;config.showq1values=0;config.showq3values=0;config.showmedianvalues=1;config.tooltipsepchar=COLON_STR;config.anchorborderthickness=1;config.anchorimageurl=UNDEF;config.anchorimagepadding=1;config.anchorsides=1;config.anchoralpha=UNDEF;config.anchorbgalpha=HUNDREDSTRING;config.anchorimagealpha=HUNDREDSTRING;config.anchorimagescale=100;config.anchorstartangle=90;config.anchorshadow=0;config.anchorbgcolor=UNDEF;config.anchorbordercolor=UNDEF;config.anchorradius=3;config.linedashlen=5;config.linedashgap=4;config.linedashed=UNDEF;config.linealpha=HUNDREDSTRING;config.linethickness=2;config.drawfullareaborder=1;config.connectnulldata=0};_proto._getLineJSONdata=function _getLineJSONdata(){var iapi=this,bwCalc=iapi.getChildren("BoxAndWhiskerStatisticalCalc")[0],jsonData=iapi.getFromEnv("dataSource"),chartAttrs=jsonData.chart,datasets=jsonData.dataset,len=datasets.length,showMean,dataset,data,dataLen,setData,derivedDS=[],currDerivedDS,requiredSubDs=[],derivedDataValue=[],currDerivedDataVal,subDSLen,currSubDS,showSD,showQD,showMD,outliers,outliersArr,valueMin,valueMax,value,fn=function fn(val){value=Number(val);var _extent=extent(bwCalc.values);valueMin=_extent[0];valueMax=_extent[1];(value<valueMin||value>valueMax)&&outliersArr.push({value:value,index:j,anchorbgcolor:setData.outliericoncolor,anchorradius:setData.outliericonradius,anchoralpha:setData.outliericonalpha,anchorbgalpha:setData.outliericonalpha,anchorsides:setData.outliericonsides,dip:setData.outliericonshape})},j,k,i;for(i=0;i<len;i++){dataset=datasets[i];currSubDS=requiredSubDs[i]={};currDerivedDataVal=derivedDataValue[i]={showMean:{seriesname:"Mean",showvalues:0,anchorbgcolor:pluck(dataset.meaniconcolor,chartAttrs.meaniconcolor,COLOR_000000),anchorbordercolor:COLOR_000000,anchorradius:pluckNumber(dataset.meaniconradius,chartAttrs.meaniconradius,5),anchoralpha:pluck(dataset.alpha,dataset.meaniconalpha,chartAttrs.meaniconalpha),linethickness:pluck(dataset.linethickness,chartAttrs.linethickness,1),anchorsides:pluck(dataset.meaniconsides,chartAttrs.meaniconsides,3),showline:!pluckNumber(dataset.drawmeanconnector,chartAttrs.drawmeanconnector),dip:pluck(dataset.meaniconshape,chartAttrs.meaniconshape,POLYGON),color:pluck(dataset.meaniconcolor,chartAttrs.meaniconcolor,COLOR_000000),data:[]},showSD:{seriesname:"SD",showvalues:0,anchorbgcolor:pluck(dataset.sdiconcolor,chartAttrs.sdiconcolor,COLOR_000000),anchorbordercolor:COLOR_000000,anchorradius:pluckNumber(dataset.sdiconradius,chartAttrs.sdiconradius,5),anchoralpha:pluck(dataset.alpha,dataset.sdiconalpha,chartAttrs.sdiconalpha),anchorbgalpha:pluck(dataset.sdiconalpha,chartAttrs.sdiconalpha,100),linethickness:pluck(dataset.linethickness,chartAttrs.linethickness,1),anchorsides:pluck(dataset.sdiconsides,chartAttrs.sdiconsides,3),showline:!pluckNumber(dataset.drawsdconnector,chartAttrs.drawsdconnector),dip:pluck(dataset.sdiconshape,chartAttrs.sdiconshape,POLYGON),color:pluck(dataset.sdiconcolor,chartAttrs.sdiconcolor,COLOR_000000),data:[]},showQD:{seriesname:"QD",showvalues:0,anchorbgcolor:pluck(dataset.qdiconcolor,chartAttrs.qdiconcolor,COLOR_000000),anchorbordercolor:COLOR_000000,anchorradius:pluckNumber(dataset.qdiconradius,chartAttrs.qdiconradius,5),anchoralpha:pluck(dataset.alpha,dataset.qdiconalpha,chartAttrs.qdiconalpha),anchorbgalpha:pluck(dataset.qdiconalpha,chartAttrs.qdiconalpha,100),linethickness:pluck(dataset.linethickness,chartAttrs.linethickness,1),anchorsides:pluck(dataset.qdiconsides,chartAttrs.qdiconsides,3),showline:!pluckNumber(dataset.drawqdconnector,chartAttrs.drawqdconnector),dip:pluck(dataset.qdiconshape,chartAttrs.qdiconshape,POLYGON),color:pluck(dataset.qdiconcolor,chartAttrs.qdiconcolor,COLOR_000000),data:[]},showMD:{seriesname:"MD",showvalues:0,anchorbgcolor:pluck(dataset.mdiconcolor,chartAttrs.mdiconcolor,COLOR_000000),anchorbordercolor:COLOR_000000,anchorradius:pluckNumber(dataset.mdiconradius,chartAttrs.mdiconradius,5),anchoralpha:pluck(dataset.alpha,dataset.mdiconalpha,chartAttrs.mdiconalpha),anchorbgalpha:pluck(dataset.mdiconalpha,chartAttrs.mdiconalpha,100),linethickness:pluck(dataset.linethickness,chartAttrs.linethickness,1),anchorsides:pluck(dataset.mdiconsides,chartAttrs.mdiconsides,3),showline:!pluckNumber(dataset.drawmdconnector,chartAttrs.drawmdconnector),dip:pluck(dataset.mdiconshape,chartAttrs.mdiconshape,POLYGON),color:pluck(dataset.mdiconcolor,chartAttrs.mdiconcolor,COLOR_000000),data:[]},outliers:{seriesname:"Outliers",showvalues:0,anchorbgcolor:pluck(dataset.outliericoncolor,chartAttrs.outliericoncolor,COLOR_000000),anchorbordercolor:COLOR_000000,anchorradius:pluckNumber(dataset.outliericonradius,chartAttrs.outliericonradius,5),anchoralpha:pluck(dataset.alpha,dataset.outliericonalpha,chartAttrs.outliericonalpha),includeinlegend:dataset.seriesname?1:0,anchorbgalpha:pluck(dataset.outliericonalpha,chartAttrs.outliericonalpha,100),linethickness:pluck(dataset.linethickness,chartAttrs.linethickness,1),anchorsides:pluck(dataset.outliericonsides,chartAttrs.outliericonsides,3),showline:!pluckNumber(dataset.drawoutliersconnector,chartAttrs.drawoutliersconnector),color:pluck(dataset.outliericoncolor,chartAttrs.outliericoncolor,COLOR_000000),dip:pluck(dataset.outliericonshape,chartAttrs.outliericonshape,POLYGON),data:[]}};showMean=pluckNumber(dataset.showmean,chartAttrs.showmean,0);showSD=pluckNumber(dataset.showsd,chartAttrs.showsd,0);showQD=pluckNumber(dataset.showqd,chartAttrs.showqd,0);showMD=pluckNumber(dataset.showmd,chartAttrs.showmd,0);data=dataset.data;dataLen=data&&data.length||0;for(j=0;j<dataLen;j++){setData=data[j];bwCalc.setArray(setData.value);bwCalc.getQuartiles();outliers=setData.outliers;showMean=currSubDS.showMean=currSubDS.showMean||pluckNumber(setData.showmean,showMean);showSD=currSubDS.showSD=currSubDS.showSD||pluckNumber(setData.showsd,showSD);showQD=currSubDS.showQD=currSubDS.showQD||pluckNumber(setData.showqd,showQD);showMD=currSubDS.showMD=currSubDS.showMD||pluckNumber(setData.showmd,showMD);currDerivedDataVal.showMean.data.push({value:showMean&&bwCalc.getMean(),anchorbgcolor:setData.meaniconcolor,anchorradius:setData.meaniconradius,anchoralpha:setData.meaniconalpha,anchorbgalpha:setData.meaniconalpha,anchorsides:setData.meaniconsides,dip:setData.meaniconshape});currDerivedDataVal.showSD.data.push({value:showSD&&bwCalc.getSD(),anchorbgcolor:setData.sdiconcolor,anchorradius:setData.sdiconradius,anchoralpha:setData.sdiconalpha,anchorbgalpha:setData.sdiconalpha,anchorsides:setData.sdiconsides,dip:setData.sdiconshape});currDerivedDataVal.showQD.data.push({value:showQD&&bwCalc.getQD(),anchorbgcolor:setData.qdiconcolor,anchorradius:setData.qdiconradius,anchoralpha:setData.qdiconalpha,anchorbgalpha:setData.qdiconalpha,anchorsides:setData.qdiconsides,dip:setData.qdiconshape});currDerivedDataVal.showMD.data.push({value:showMD&&bwCalc.getMD(),anchorbgcolor:setData.mdiconcolor,anchorradius:setData.mdiconradius,anchoralpha:setData.mdiconalpha,anchorbgalpha:setData.mdiconalpha,anchorsides:setData.mdiconsides,dip:setData.mdiconshape});if(outliers){outliersArr=currDerivedDataVal.outliers.data;outliers.split(COMMA).forEach(fn);currSubDS.outliers=true}}}subDSLen=requiredSubDs.length;for(k=0;k<subDSLen;k++){currSubDS=requiredSubDs[k];currDerivedDS=derivedDS[k]=[];for(i in currSubDS){currSubDS[i]&&currDerivedDS.push(derivedDataValue[k][i])}}return derivedDS};_proto.getDSdef=function getDSdef(){return BoxAndWhiskerDataset};_proto.getDSGroupdef=function getDSGroupdef(){return BoxAndWhiskerMultiSeriesGroup};return BoxAndWhisker2D}(MSColumn2D);export default BoxAndWhisker2D;