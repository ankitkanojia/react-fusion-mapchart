import _inheritsLoose from"@babel/runtime/helpers/inheritsLoose";import GaugeWidget from"./gaugewidget";import MessageLogger from"@fusioncharts/features/src/messagelogger";import AlertManager from"@fusioncharts/features/src/alertmanager";import FusionCharts from"@fusioncharts/constructor/src/constructor";import{pluck,pluckNumber,pluckFontSize,chartPaletteStr,BLANK}from"@fusioncharts/core/src/lib";import isEqualString from"@fusioncharts/utils/src/string/equal";var UNDEF;var Gauge=function(_GaugeWidget){_inheritsLoose(Gauge,_GaugeWidget);function Gauge(){var _this;_this=_GaugeWidget.call(this)||this;FusionCharts.addDep(MessageLogger);FusionCharts.addDep(AlertManager);_this.chartLeftMargin=15;_this.chartRightMargin=15;_this.chartTopMargin=10;_this.chartBottomMargin=10;_this.minChartHeight=10;_this.minCanvasWidth=0;return _this}var _proto=Gauge.prototype;_proto._feedAxesRawData=function _feedAxesRawData(){var iapi=this,config=iapi.config,colorM=iapi.getFromEnv("color-manager"),dataObj=iapi.getFromEnv("dataSource"),chartAttrs=dataObj.chart,scaleConf,palleteString=chartPaletteStr.chart2D,ticksBelowGauge=pluckNumber(chartAttrs.ticksbelowgauge),ticksonright=pluckNumber(chartAttrs.ticksonright),isAxisOpposite=pluckNumber(isEqualString(chartAttrs.scaleposition,config.scalePosition)?config.isAxisOpposite:isEqualString(chartAttrs.scaleposition,config.canBeScalePosition)?!config.isAxisOpposite:UNDEF,ticksBelowGauge!==UNDEF?!ticksBelowGauge:UNDEF,ticksonright!==UNDEF?ticksonright:UNDEF,config.isAxisOpposite),isAxisReverse=pluckNumber(chartAttrs.reverseaxis,iapi.isAxisReverse),showTickMarks=pluckNumber(chartAttrs.showtickmarks,1),numberFormatter=iapi.getFromEnv("number-formatter"),showTickValues=pluckNumber(chartAttrs.showtickvalues),showLimits;if(!showTickValues&&showTickValues!==UNDEF){showLimits=false}else if(!showTickMarks&&showTickValues===UNDEF){showLimits=false}else{showLimits=true}scaleConf={isVertical:!iapi.isHorizontal,isReverse:iapi.isHorizontal?isAxisReverse:!isAxisReverse,isOpposit:isAxisOpposite,outCanfontFamily:pluck(chartAttrs.outcnvbasefont,chartAttrs.basefont,"Verdana,sans"),outCanfontSize:pluckFontSize(chartAttrs.outcnvbasefontsize,chartAttrs.basefontsize,10),outCancolor:pluck(chartAttrs.outcnvbasefontcolor,chartAttrs.basefontcolor,colorM.getColor(palleteString.baseFontColor)).replace(/^#?([a-f0-9]+)/gi,"#$1"),useEllipsesWhenOverflow:chartAttrs.useellipseswhenoverflow,divLineColor:pluck(chartAttrs.vdivlinecolor,colorM.getColor(palleteString.divLineColor)),divLineAlpha:pluck(chartAttrs.vdivlinealpha,colorM.getColor("divLineAlpha")),divLineThickness:pluckNumber(chartAttrs.vdivlinethickness,1),divLineIsDashed:Boolean(pluckNumber(chartAttrs.vdivlinedashed,chartAttrs.vdivlineisdashed,0)),divLineDashLen:pluckNumber(chartAttrs.vdivlinedashlen,4),divLineDashGap:pluckNumber(chartAttrs.vdivlinedashgap,2),showAlternateGridColor:pluckNumber(chartAttrs.showalternatevgridcolor,0),alternateGridColor:pluck(chartAttrs.alternatevgridcolor,colorM.getColor("altVGridColor")),alternateGridAlpha:pluck(chartAttrs.alternatevgridalpha,colorM.getColor("altVGridAlpha")),numDivLines:chartAttrs.numvdivlines,labelFont:chartAttrs.labelfont,labelFontSize:chartAttrs.labelfontsize,labelFontColor:chartAttrs.labelfontcolor,labelAlpha:chartAttrs.labelalpha,labelFontBold:chartAttrs.labelfontbold,labelFontItalic:chartAttrs.labelfontitalic,axisName:chartAttrs.xaxisname,axisMinValue:numberFormatter.getCleanValue(chartAttrs.lowerlimit),axisMaxValue:numberFormatter.getCleanValue(chartAttrs.upperlimit),setAdaptiveMin:chartAttrs.setadaptivemin,adjustDiv:chartAttrs.adjusttm,labelDisplay:chartAttrs.labeldisplay,showLabels:chartAttrs.showlabels,rotateLabels:chartAttrs.rotatelabels,slantLabel:pluckNumber(chartAttrs.slantlabels,chartAttrs.slantlabel),labelStep:pluckNumber(chartAttrs.labelstep,chartAttrs.xaxisvaluesstep),showAxisValues:pluckNumber(chartAttrs.showxaxisvalues,chartAttrs.showxaxisvalue),showDivLineValues:pluckNumber(chartAttrs.showvdivlinevalues,chartAttrs.showvdivlinevalues),showZeroPlane:chartAttrs.showvzeroplane,zeroPlaneColor:chartAttrs.vzeroplanecolor,zeroPlaneThickness:chartAttrs.vzeroplanethickness,zeroPlaneAlpha:chartAttrs.vzeroplanealpha,showZeroPlaneValue:chartAttrs.showvzeroplanevalue,trendlineColor:chartAttrs.trendlinecolor,trendlineToolText:chartAttrs.trendlinetooltext,trendlineThickness:chartAttrs.trendlinethickness,trendlineAlpha:chartAttrs.trendlinealpha,showTrendlinesOnTop:chartAttrs.showtrendlinesontop,showAxisLine:pluckNumber(chartAttrs.showxaxisline,chartAttrs.showaxislines,chartAttrs.drawAxisLines,0),axisLineThickness:pluckNumber(chartAttrs.xaxislinethickness,chartAttrs.axislinethickness,1),axisLineAlpha:pluckNumber(chartAttrs.xaxislinealpha,chartAttrs.axislinealpha,100),axisLineColor:pluck(chartAttrs.xaxislinecolor,chartAttrs.axislinecolor,"#000000"),majorTMNumber:chartAttrs.majortmnumber,majorTMColor:chartAttrs.majortmcolor,majorTMAlpha:chartAttrs.majortmalpha,majorTMHeight:chartAttrs.majortmheight,tickValueStep:chartAttrs.tickvaluestep,showTickMarks:chartAttrs.showtickmarks,connectTickMarks:chartAttrs.connecttickmarks,showTickValues:chartAttrs.showtickvalues,majorTMThickness:chartAttrs.majortmthickness,reverseScale:chartAttrs.reversescale,showLimits:chartAttrs.showlimits||showLimits,minorTMNumber:pluckNumber(chartAttrs.minortmnumber,iapi.minorTMNumber,4),minorTMColor:chartAttrs.minortmcolor,minorTMAlpha:chartAttrs.minortmalpha,minorTMHeight:pluckNumber(chartAttrs.minortmheight,chartAttrs.minortmwidth),minorTMThickness:chartAttrs.minortmthickness,tickMarkDistance:pluckNumber(chartAttrs.tickmarkdistance,chartAttrs.tickmarkgap),tickValueDistance:pluckNumber(chartAttrs.tickvaluedistance,chartAttrs.displayvaluedistance),placeTicksInside:chartAttrs.placeticksinside,placeValuesInside:chartAttrs.placevaluesinside,upperLimitDisplay:chartAttrs.upperlimitdisplay,lowerLimitDisplay:chartAttrs.lowerlimitdisplay,drawTickMarkConnector:iapi.isHorizontal?1:0};scaleConf.vtrendlines=dataObj.trendpoints;return[scaleConf]};_proto._setAxisLimits=function _setAxisLimits(){var iapi=this,chartAttrs=iapi.getFromEnv("dataSource").chart,scale=iapi.getChildren("scale")[0],minMaxObj;minMaxObj=iapi.getChildren("dataset")[0].getDataLimits();minMaxObj.max===-Infinity&&(minMaxObj.max=0);minMaxObj.min===Infinity&&(minMaxObj.min=0);iapi.colorRange&&scale.setAxisConfig({axisMinValue:pluckNumber(chartAttrs.lowerlimit,minMaxObj.forceMin?minMaxObj.min:UNDEF),axisMaxValue:pluckNumber(chartAttrs.upperlimit,minMaxObj.forceMax?minMaxObj.max:UNDEF)});scale.setDataLimit(minMaxObj.max,minMaxObj.min)};_proto._getDataJSON=function _getDataJSON(){var i=0,len,dataObj,values=[],labels=[],toolTexts=[],data=this.getChildren("dataset")[0].components.data;if(!data||!data.length){len=0}else{len=data.length}for(;i<len;i+=1){dataObj=data[i].config;values.push(dataObj.itemValue);labels.push(dataObj.formatedVal||BLANK);toolTexts.push(dataObj.toolText||BLANK)}return{values:values,labels:labels,toolTexts:toolTexts}};_proto._postSpaceManagement=function _postSpaceManagement(){var iapi=this,config=iapi.config,canvas=iapi.getChildren("canvas")[0],scale=iapi.getChildren("scale")[0],isHorizontal=iapi.isHorizontal,canvasConf=canvas.config;if(isHorizontal){scale.setAxisDimention({axisLength:config.canvasWidth,y:canvasConf.canvasTop+(scale.config.isOpposit?0:canvasConf.canvasHeight),x:canvasConf.canvasLeft})}else{scale.setAxisDimention({axisLength:config.canvasHeight,x:canvasConf.canvasLeft+(scale.config.isOpposit?canvasConf.canvasWidth:0),y:canvasConf.canvasTop})}iapi.allocateDimensionOfChartMenuBar()};_proto._clearChart=function _clearChart(){};return Gauge}(GaugeWidget);export default Gauge;