import{DatetimeUnits}from"@fusioncharts/utils/src/datetime-enums";import getValidBin from"./validate-binsize";export default function(specifier,index,data,standardBins,intervalIndexMap){if(data===void 0){data=[]}var timeUnits=[],i,diff,prevDate,currentDate,bin,count,minInfo={count:0},multipliersCountMap,len=data.length,store={};if(!specifier)return null;if(/%[_ -]?[cfLQ]/.test(specifier)){timeUnits.push(DatetimeUnits.Millisecond);store[DatetimeUnits.Millisecond.name]={}}if(/%[_ -]?[sSX]/.test(specifier)){timeUnits.push(DatetimeUnits.Second);store[DatetimeUnits.Second.name]={}}if(/%[_ -]?M/.test(specifier)){timeUnits.push(DatetimeUnits.Minute);store[DatetimeUnits.Minute.name]={}}if(/%[_ -]?[HI]/.test(specifier)){timeUnits.push(DatetimeUnits.Hour);store[DatetimeUnits.Hour.name]={}}if(/%[_ -]?[dejuwx]/.test(specifier)){timeUnits.push(DatetimeUnits.Day);store[DatetimeUnits.Day.name]={}}if(/%[_ -]?[bBm]/.test(specifier)){timeUnits.push(DatetimeUnits.Month);store[DatetimeUnits.Month.name]={}}if(/%[_ -]?[yY]/.test(specifier)){timeUnits.push(DatetimeUnits.Year);store[DatetimeUnits.Year.name]={}}if(!timeUnits.length){return[]}if(len===1||len===0){return[timeUnits[0].ms,1,timeUnits[0].ms]}for(i=1;i<len;++i){prevDate=data[i-1][index];currentDate=data[i][index];diff=currentDate-prevDate;if(!diff)continue;bin=getValidBin(standardBins,intervalIndexMap,timeUnits,diff);multipliersCountMap=store[bin.unit.name];if(!multipliersCountMap[bin.multiplier]){multipliersCountMap[bin.multiplier]=0}count=++multipliersCountMap[bin.multiplier];if(minInfo.count<count||minInfo.count===count&&minInfo.unit.ms*minInfo.multiplier>bin.unit.ms*bin.multiplier){minInfo.count=count;Object.assign(minInfo,bin)}}return minInfo.count?[minInfo.unit.ms,minInfo.multiplier,minInfo.multiplier*minInfo.unit.ms]:[timeUnits[0].ms,1,timeUnits[0].ms]}